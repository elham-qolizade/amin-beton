{
    "sourceFile": "src/user-panel/HistoryProject.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1744154697144,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1744154882499,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -285,21 +285,8 @@\n     }\r\n   };\r\n \r\n   // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª ÙØ§Ú©ØªÙˆØ±Ù‡Ø§\r\n-  // const getInvoices = async () => {\r\n-  //   try {\r\n-  //     const response = await axios.get(\r\n-  //       `https://amin-beton-back.chbk.app/api/orders/${id}/get-order-invoices/`,\r\n-  //       {\r\n-  //         headers: { Authorization: `Bearer ${token}` },\r\n-  //       }\r\n-  //     );\r\n-  //     setInvoices(response.data); // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ù‡ Ø±ÙˆØ² Ù…ÛŒâ€ŒÚ©Ù†Ø¯\r\n-  //   } catch (error) {\r\n-  //     console.error(\"Error fetching invoices:\", error);\r\n-  //   }\r\n-  // };\r\n \r\n   const handleStatusButtonClick = (invoice) => {\r\n     const selectedStatus = invoiceStatuses[invoice.id];\r\n \r\n"
                },
                {
                    "date": 1744155177766,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -488,71 +488,9 @@\n               <button onClick={() => fetchAndDownloadInvoice(id)}>\r\n                 ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù¾ÛŒØ´â€ŒÙØ§Ú©ØªÙˆØ±\r\n               </button>\r\n \r\n-              {invoices.length === 0 ? (\r\n-                <p>Ù‡ÛŒÚ† ÙØ§Ú©ØªÙˆØ±ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª.</p>\r\n-              ) : (\r\n-                invoices.map((invoice) => (\r\n-                  <div\r\n-                    key={invoice.id}\r\n-                    style={{\r\n-                      border: \"1px solid #ccc\",\r\n-                      padding: \"10px\",\r\n-                      margin: \"10px\",\r\n-                    }}\r\n-                  >\r\n-                    <p>ğŸ’° Ù…Ø¨Ù„Øº: {invoice.price}</p>\r\n-                    <p>\r\n-                      ğŸ“„ ÙˆØ¶Ø¹ÛŒØª:{\" \"}\r\n-                      {invoice.status === 1\r\n-                        ? \"Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ§ÛŒÛŒØ¯\"\r\n-                        : invoice.status === 2\r\n-                        ? \"Ø±Ø¯ Ø´Ø¯Ù‡\"\r\n-                        : \"ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡\"}\r\n-                    </p>\r\n-                    {invoice.status === 3 && invoice.deny_reason && (\r\n-                      <p>ğŸ›‘ Ø¯Ù„ÛŒÙ„ Ø±Ø¯: {invoice.deny_reason}</p>\r\n-                    )}\r\n-                    {invoice.status === 1 && (\r\n-                      <div>\r\n-                        <select\r\n-                          onChange={(e) =>\r\n-                            setInvoiceStatuses((prev) => ({\r\n-                              ...prev,\r\n-                              [invoice.id]: e.target.value,\r\n-                            }))\r\n-                          }\r\n-                        >\r\n-                          <option value=\"\">-- Ø§Ù†ØªØ®Ø§Ø¨ ÙˆØ¶Ø¹ÛŒØª --</option>\r\n-                          <option value=\"approved\">âœ… ØªØ§ÛŒÛŒØ¯</option>\r\n-                          <option value=\"rejected\">âŒ Ø±Ø¯</option>\r\n-                        </select>\r\n-\r\n-                        {invoiceStatuses[invoice.id] === \"rejected\" && (\r\n-                          <input\r\n-                            type=\"text\"\r\n-                            placeholder=\"Ø¯Ù„ÛŒÙ„ Ø±Ø¯\"\r\n-                            onChange={(e) =>\r\n-                              setDenyReasons((prev) => ({\r\n-                                ...prev,\r\n-                                [invoice.id]: e.target.value,\r\n-                              }))\r\n-                            }\r\n-                          />\r\n-                        )}\r\n-                        <div className=\"py-10 border-b border-white bg-School-Bus\">\r\n-                          <button\r\n-                            onClick={() => handleStatusButtonClick(invoice)}\r\n-                          >\r\n-                            Ø«Ø¨Øª ÙˆØ¶Ø¹ÛŒØª\r\n-                          </button>\r\n-                        </div>\r\n-                      </div>\r\n-                    )}\r\n-                  </div>\r\n-                ))\r\n-              )}\r\n+        \r\n             </div>\r\n             <button onClick={() => handleStatusChange()}>Ø«Ø¨Øª ÙˆØ¶Ø¹ÛŒØª</button>\r\n             <div className=\"py-10 border-b border-white\">\r\n               <ButtonProject\r\n"
                },
                {
                    "date": 1744155243354,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,8 +22,13 @@\n   const [denyReasons, setDenyReasons] = useState({});\r\n   const [location, setLocation] = useState(null);\r\n   const [selectedImei, setSelectedImei] = useState(null);\r\n   const { id } = useParams();\r\n+  const statusMap = {\r\n+    1: \"Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø±Ø±Ø³ÛŒ\",\r\n+    2: \"ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡\",\r\n+    3: \"Ø±Ø¯ Ø´Ø¯Ù‡\"\r\n+  };\r\n   // Ù…Ù‚Ø¯Ø§Ø± orderId Ø±Ùˆ Ø³Øª Ú©Ù† ÙˆÙ‚ØªÛŒ Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ù„ÙˆØ¯ Ù…ÛŒØ´Ù‡\r\n   // Ø§ÛŒÙ† Ù‚Ø³Ù…Øª Ø±Ùˆ Ø§ØµÙ„Ø§Ø­ Ú©Ù†\r\n   useEffect(() => {\r\n     if (id) {\r\n"
                },
                {
                    "date": 1744155275949,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,8 +27,32 @@\n     1: \"Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø±Ø±Ø³ÛŒ\",\r\n     2: \"ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡\",\r\n     3: \"Ø±Ø¯ Ø´Ø¯Ù‡\",\r\n   };\r\n+  if (!invoices || invoices.length === 0) {\r\n+    return <p className=\"text-center text-gray-500\">Ù¾ÛŒØ´â€ŒÙØ§Ú©ØªÙˆØ±ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡</p>;\r\n+  }\r\n+\r\n+  const [statusUpdates, setStatusUpdates] = useState({});\r\n+  const [loading, setLoading] = useState(false);\r\n+\r\n+  const handleStatusChange = async (id, newStatus, reason) => {\r\n+    setLoading(true);\r\n+    try {\r\n+      await axios.post(\"https://amin-beton-back.chbk.app/api/invoices/change_invoice_status/\", {\r\n+        id,\r\n+        status: newStatus,\r\n+        deny_reason: reason || \"\"\r\n+      });\r\n+      alert(\"Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯.\");\r\n+      window.location.reload(); // Ø±ÙØ±Ø´ ØµÙØ­Ù‡\r\n+    } catch (error) {\r\n+      console.error(error);\r\n+      alert(\"Ø®Ø·Ø§ÛŒÛŒ Ø±Ø® Ø¯Ø§Ø¯.\");\r\n+    } finally {\r\n+      setLoading(false);\r\n+    }\r\n+  };\r\n   // Ù…Ù‚Ø¯Ø§Ø± orderId Ø±Ùˆ Ø³Øª Ú©Ù† ÙˆÙ‚ØªÛŒ Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ù„ÙˆØ¯ Ù…ÛŒØ´Ù‡\r\n   // Ø§ÛŒÙ† Ù‚Ø³Ù…Øª Ø±Ùˆ Ø§ØµÙ„Ø§Ø­ Ú©Ù†\r\n   useEffect(() => {\r\n     if (id) {\r\n@@ -172,46 +196,46 @@\n       }\r\n     }\r\n   };\r\n \r\n-  const handleStatusChange = async (invoiceId, status, denyReason = \"\") => {\r\n-    if (!invoiceId) {\r\n-      console.error(\"âŒ Ø´Ù†Ø§Ø³Ù‡ ÙØ§Ú©ØªÙˆØ± Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª.\");\r\n-      alert(\"âš ï¸ Ø´Ù†Ø§Ø³Ù‡ ÙØ§Ú©ØªÙˆØ± Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª.\");\r\n-      return;\r\n-    }\r\n+  // const handleStatusChange = async (invoiceId, status, denyReason = \"\") => {\r\n+  //   if (!invoiceId) {\r\n+  //     console.error(\"âŒ Ø´Ù†Ø§Ø³Ù‡ ÙØ§Ú©ØªÙˆØ± Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª.\");\r\n+  //     alert(\"âš ï¸ Ø´Ù†Ø§Ø³Ù‡ ÙØ§Ú©ØªÙˆØ± Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª.\");\r\n+  //     return;\r\n+  //   }\r\n \r\n-    const data = {\r\n-      invoice_id: invoiceId,\r\n-      status: status === \"approved\" ? 1 : 2, // ÙØ±Ø¶ Ø¨Ø± Ø§ÛŒÙ†Ú©Ù‡ ÙˆØ¶Ø¹ÛŒØª Ø¹Ø¯Ø¯ÛŒ Ø§Ø³Øª\r\n-      deny_reason: status === \"rejected\" ? denyReason : \"\",\r\n-    };\r\n+  //   const data = {\r\n+  //     invoice_id: invoiceId,\r\n+  //     status: status === \"approved\" ? 1 : 2, // ÙØ±Ø¶ Ø¨Ø± Ø§ÛŒÙ†Ú©Ù‡ ÙˆØ¶Ø¹ÛŒØª Ø¹Ø¯Ø¯ÛŒ Ø§Ø³Øª\r\n+  //     deny_reason: status === \"rejected\" ? denyReason : \"\",\r\n+  //   };\r\n \r\n-    try {\r\n-      const url = `https://amin-beton-back.chbk.app/api/invoices/${invoiceId}/change-invoice-status/`;\r\n-      console.log(\"API URL:\", url); // Ù„Ø§Ú¯ URL Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ\r\n+  //   try {\r\n+  //     const url = `https://amin-beton-back.chbk.app/api/invoices/${invoiceId}/change-invoice-status/`;\r\n+  //     console.log(\"API URL:\", url); // Ù„Ø§Ú¯ URL Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ\r\n \r\n-      await axios.post(url, data, {\r\n-        headers: {\r\n-          \"Content-Type\": \"application/json\",\r\n-          Authorization: `Bearer ${token}`,\r\n-        },\r\n-      });\r\n+  //     await axios.post(url, data, {\r\n+  //       headers: {\r\n+  //         \"Content-Type\": \"application/json\",\r\n+  //         Authorization: `Bearer ${token}`,\r\n+  //       },\r\n+  //     });\r\n \r\n-      // Ù„Ø§Ú¯ Ú©Ø±Ø¯Ù† invoiceIdØŒ status Ùˆ denyReason\r\n-      console.log(\"Invoice ID:\", invoiceId);\r\n-      console.log(\"Status:\", status);\r\n-      console.log(\"Deny Reason:\", denyReason);\r\n+  //     // Ù„Ø§Ú¯ Ú©Ø±Ø¯Ù† invoiceIdØŒ status Ùˆ denyReason\r\n+  //     console.log(\"Invoice ID:\", invoiceId);\r\n+  //     console.log(\"Status:\", status);\r\n+  //     console.log(\"Deny Reason:\", denyReason);\r\n \r\n-      // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª ÙØ§Ú©ØªÙˆØ±Ù‡Ø§\r\n-      getInvoices(); // Ø§ÛŒÙ†Ø¬Ø§ ØªØ§Ø¨Ø¹ÛŒ Ø§Ø³Øª Ú©Ù‡ Ù„ÛŒØ³Øª ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯\r\n+  //     // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª ÙØ§Ú©ØªÙˆØ±Ù‡Ø§\r\n+  //     getInvoices(); // Ø§ÛŒÙ†Ø¬Ø§ ØªØ§Ø¨Ø¹ÛŒ Ø§Ø³Øª Ú©Ù‡ Ù„ÛŒØ³Øª ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯\r\n \r\n-      alert(\"âœ… ÙˆØ¶Ø¹ÛŒØª ÙØ§Ú©ØªÙˆØ± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªØºÛŒÛŒØ± Ú©Ø±Ø¯.\");\r\n-    } catch (error) {\r\n-      console.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª:\", error);\r\n-      alert(\"âš ï¸ ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ù†Ø´Ø¯.\");\r\n-    }\r\n-  };\r\n+  //     alert(\"âœ… ÙˆØ¶Ø¹ÛŒØª ÙØ§Ú©ØªÙˆØ± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªØºÛŒÛŒØ± Ú©Ø±Ø¯.\");\r\n+  //   } catch (error) {\r\n+  //     console.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª:\", error);\r\n+  //     alert(\"âš ï¸ ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ù†Ø´Ø¯.\");\r\n+  //   }\r\n+  // };\r\n \r\n   // Get Token from Local Storage\r\n   const token = localStorage.getItem(\"accessToken\");\r\n   if (!token) {\r\n"
                },
                {
                    "date": 1744155353182,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -519,8 +519,9 @@\n             <div className=\"py-10 border-b border-white bg-School-Bus\">\r\n               <button onClick={() => fetchAndDownloadInvoice(id)}>\r\n                 ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù¾ÛŒØ´â€ŒÙØ§Ú©ØªÙˆØ±\r\n               </button>\r\n+              \r\n             </div>\r\n             <button onClick={() => handleStatusChange()}>Ø«Ø¨Øª ÙˆØ¶Ø¹ÛŒØª</button>\r\n             <div className=\"py-10 border-b border-white\">\r\n               <ButtonProject\r\n"
                }
            ],
            "date": 1744154697144,
            "name": "Commit-0",
            "content": "import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nimport HeaderNav from \"../ui/HeadingNav\";\r\nimport ProjectHeading from \"../ui/projectHeading\";\r\nimport ButtonProject from \"../ui/ButtonProject\";\r\nimport ProgressCircle from \"../ui/ProgressCircl\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport { VehicleTracking } from \"../constans/index\";\r\n\r\nimport { MdOutlineFileDownload } from \"react-icons/md\";\r\nimport MapComponent from \"../ui/MapComponent\";\r\nconst HistoryProject = () => {\r\n  const [factor, setFactor] = useState(null);\r\n  const [invoices, setInvoices] = useState([]);\r\n  const [categories, setCategories] = useState([]);\r\n  const [bills, setBills] = useState([]);\r\n  const [reportContent, setReportContent] = useState(\"\"); // âœ… Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† reportContent\r\n  // Ø¯Ø±ÛŒØ§ÙØª orderId Ø§Ø² URL\r\n  // const [invoices, setInvoices] = useState([]);\r\n  const [actionData, setActionData] = useState({});\r\n  const [denyReasons, setDenyReasons] = useState({});\r\n  const [location, setLocation] = useState(null);\r\n  const [selectedImei, setSelectedImei] = useState(null);\r\n  const { id } = useParams();\r\n  // Ù…Ù‚Ø¯Ø§Ø± orderId Ø±Ùˆ Ø³Øª Ú©Ù† ÙˆÙ‚ØªÛŒ Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ù„ÙˆØ¯ Ù…ÛŒØ´Ù‡\r\n  // Ø§ÛŒÙ† Ù‚Ø³Ù…Øª Ø±Ùˆ Ø§ØµÙ„Ø§Ø­ Ú©Ù†\r\n  useEffect(() => {\r\n    if (id) {\r\n      handleStatusChange();\r\n      fetchAndDownloadInvoice(id); // Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª ÙØ§Ú©ØªÙˆØ±Ù‡Ø§\r\n      getBillsOfLading(id); // Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø¨Ø§Ø±Ù†Ø§Ù…Ù‡â€ŒÙ‡Ø§\r\n    }\r\n  }, [id]);\r\n\r\n  useEffect(() => {\r\n    console.log(\"Received Order ID:\", id); // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§ÛŒÙ† Ø®Ø·\r\n\r\n    if (id) {\r\n      // downloadFactorReport(id); // Ø§Ø±Ø³Ø§Ù„ id Ø¨Ù‡ ØªÙˆØ§Ø¨Ø¹\r\n      // getInvoices(id);\r\n    }\r\n    getCategories(); // Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø¬Ø±Ø§ Ø¨Ø´Ù‡\r\n  }, [id]);\r\n  const handleShowLocation = (imei) => {\r\n    setSelectedImei(imei); // IMEI Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ Ø±Ø§ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…\r\n    getLocation(imei).then((location) => {\r\n      setLocations((prevLocations) => ({\r\n        ...prevLocations,\r\n        [imei]: location,\r\n      }));\r\n    }); // ÙØ±Ø¶ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… getLocation ÛŒÚ© Promise Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯ Ú©Ù‡ Ù…ÙˆÙ‚Ø¹ÛŒØª Ø±Ø§ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯\r\n  };\r\n\r\n  const handleUpdateLocation = (imei) => {\r\n    getLocation(imei).then((location) => {\r\n      setLocations((prevLocations) => ({\r\n        ...prevLocations,\r\n        [imei]: location,\r\n      }));\r\n    }); // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÙˆÙ‚Ø¹ÛŒØª\r\n  };\r\n\r\n  const navigate = useNavigate(); // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² useNavigate Ø¨Ø±Ø§ÛŒ Ù‡Ø¯Ø§ÛŒØª Ø¨Ù‡ ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯\r\n\r\n  // ØªØ§Ø¨Ø¹ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ùˆ Ù†Ù…Ø§ÛŒØ´ Ú¯Ø²Ø§Ø±Ø´\r\n  const downloadAndViewReport = async (reportUrl) => {\r\n    try {\r\n      const response = await axios.get(reportUrl, {\r\n        responseType: \"blob\", // Ø¯Ø±ÛŒØ§ÙØª Ø¨Ù‡ ØµÙˆØ±Øª blob Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„\r\n      });\r\n\r\n      // Ø§ÛŒØ¬Ø§Ø¯ Ù„ÛŒÙ†Ú© Ø¯Ø§Ù†Ù„ÙˆØ¯\r\n      const url = window.URL.createObjectURL(new Blob([response.data]));\r\n      const link = document.createElement(\"a\");\r\n      link.href = url;\r\n      link.setAttribute(\"download\", \"report.pdf\"); // ØªØºÛŒÛŒØ± Ù†Ø§Ù… ÙØ§ÛŒÙ„ Ø¨Ù‡ Ú¯Ø²Ø§Ø±Ø´\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n\r\n      // Ø®ÙˆØ§Ù†Ø¯Ù† Ùˆ Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØªÙˆÛŒØ§Øª Ú¯Ø²Ø§Ø±Ø´\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => {\r\n        setReportContent(e.target.result); // Ø°Ø®ÛŒØ±Ù‡ Ù…Ø­ØªÙˆÛŒØ§Øª Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´\r\n      };\r\n      reader.readAsText(response.data);\r\n    } catch (error) {\r\n      console.error(\"Error downloading report:\", error);\r\n    }\r\n  };\r\n\r\n  // ØªØ§Ø¨Ø¹ Ø§ÛŒØ¬Ø§Ø¯ Ùˆ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ú¯Ø²Ø§Ø±Ø´ ÙØ§Ú©ØªÙˆØ± âœ…\r\n  const downloadFactorReport = async (orderId) => {\r\n    if (!orderId || isNaN(orderId)) {\r\n      alert(\"âš ï¸ Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø´Ù†Ø§Ø³Ù‡ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await axios.post(\r\n        \"https://amin-beton-back.chbk.app/api/orders/get-order-factor/\",\r\n        {\r\n          order_id: parseInt(orderId),\r\n        },\r\n        {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        }\r\n      );\r\n\r\n      const factor = response.data;\r\n      const invoiceId = factor.invoice_id; // ÙØ±Ø¶ Ø¨Ø± Ø§ÛŒÙ†Ú©Ù‡ invoice_id Ø¯Ø± Ù¾Ø§Ø³Ø® Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª\r\n      console.log(\"Invoice ID extracted from response:\", invoiceId);\r\n      if (!factor) {\r\n        alert(\"â›” ÙØ§Ú©ØªÙˆØ±ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø³ÙØ§Ø±Ø´ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡.\");\r\n        return;\r\n      }\r\n\r\n      // Ø§Ø³ØªØ®Ø±Ø§Ø¬ invoiceId Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø§Ø³Ø®\r\n      // const invoiceId = factor.invoice_id; // ÙØ±Ø¶ Ø¨Ø± Ø§ÛŒÙ†Ú©Ù‡ invoice_id Ø¯Ø± Ù¾Ø§Ø³Ø® Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª\r\n\r\n      if (!invoiceId) {\r\n        alert(\"â›” Ø´Ù†Ø§Ø³Ù‡ ÙØ§Ú©ØªÙˆØ± Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯.\");\r\n        return;\r\n      }\r\n\r\n      // Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª Ùˆ ÙØ§ÛŒÙ„ Ø¯Ø± Console ÛŒØ§ UI (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)\r\n      console.log(\"ğŸ’° Ù‚ÛŒÙ…Øª:\", factor.price);\r\n      console.log(\"ğŸ§¾ ÙØ§ÛŒÙ„ ÙØ§Ú©ØªÙˆØ±:\", factor.invoice_file);\r\n\r\n      const factorContent = `\r\n        ğŸ“„ Ú¯Ø²Ø§Ø±Ø´ Ù¾ÛŒØ´â€ŒÙØ§Ú©ØªÙˆØ±\r\n        =========================\r\n        ğŸ’° Ù…Ø¨Ù„Øº: ${factor.price}\r\n        ğŸ“ ØªÙˆØ¶ÛŒØ­Ø§Øª: ${factor.report || \"Ú¯Ø²Ø§Ø±Ø´ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡\"}\r\n        =========================\r\n      `;\r\n\r\n      const blob = new Blob([factorContent], { type: \"text/plain\" });\r\n      const url = window.URL.createObjectURL(blob);\r\n\r\n      const link = document.createElement(\"a\");\r\n      link.href = url;\r\n      link.setAttribute(\"download\", `factor_report_${orderId}.txt`);\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n\r\n      alert(\"âœ… ÙØ§ÛŒÙ„ Ú¯Ø²Ø§Ø±Ø´ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯.\");\r\n\r\n      // ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ ØªØ§Ø¨Ø¹ handleStatusChange Ø¨Ø§ invoiceId\r\n      const status = \"approved\"; // ÙØ±Ø¶ÛŒ: Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ÙˆØ¶Ø¹ÛŒØª Ø±Ø§ Ø¨Ù‡ Ø¯Ù„Ø®ÙˆØ§Ù‡ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯\r\n      const denyReason = \"\"; // ÙØ±Ø¶ÛŒ: Ø§Ú¯Ø± ÙˆØ¶Ø¹ÛŒØª \"rejected\" Ø¨Ø§Ø´Ø¯ØŒ Ø¯Ù„ÛŒÙ„ Ø±Ø¯ Ø±Ø§ Ø§Ø±Ø³Ø§Ù„ Ú©Ù†ÛŒØ¯\r\n      handleStatusChange(invoiceId, status, denyReason);\r\n    } catch (error) {\r\n      if (error.response?.status === 404) {\r\n        alert(\"â›” ÙØ§Ú©ØªÙˆØ±ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø³ÙØ§Ø±Ø´ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡.\");\r\n      } else {\r\n        console.error(\r\n          \"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª ÙØ§Ú©ØªÙˆØ±:\",\r\n          error.response?.data || error\r\n        );\r\n        alert(\"âš ï¸ Ø®Ø·Ø§ÛŒÛŒ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª ÙØ§Ú©ØªÙˆØ± Ø±Ø® Ø¯Ø§Ø¯Ù‡ Ø§Ø³Øª.\");\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleStatusChange = async (invoiceId, status, denyReason = \"\") => {\r\n    if (!invoiceId) {\r\n      console.error(\"âŒ Ø´Ù†Ø§Ø³Ù‡ ÙØ§Ú©ØªÙˆØ± Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª.\");\r\n      alert(\"âš ï¸ Ø´Ù†Ø§Ø³Ù‡ ÙØ§Ú©ØªÙˆØ± Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª.\");\r\n      return;\r\n    }\r\n\r\n    const data = {\r\n      invoice_id: invoiceId,\r\n      status: status === \"approved\" ? 1 : 2, // ÙØ±Ø¶ Ø¨Ø± Ø§ÛŒÙ†Ú©Ù‡ ÙˆØ¶Ø¹ÛŒØª Ø¹Ø¯Ø¯ÛŒ Ø§Ø³Øª\r\n      deny_reason: status === \"rejected\" ? denyReason : \"\",\r\n    };\r\n\r\n    try {\r\n      const url = `https://amin-beton-back.chbk.app/api/invoices/${invoiceId}/change-invoice-status/`;\r\n      console.log(\"API URL:\", url); // Ù„Ø§Ú¯ URL Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ\r\n\r\n      await axios.post(url, data, {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n\r\n      // Ù„Ø§Ú¯ Ú©Ø±Ø¯Ù† invoiceIdØŒ status Ùˆ denyReason\r\n      console.log(\"Invoice ID:\", invoiceId);\r\n      console.log(\"Status:\", status);\r\n      console.log(\"Deny Reason:\", denyReason);\r\n\r\n      // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª ÙØ§Ú©ØªÙˆØ±Ù‡Ø§\r\n      getInvoices(); // Ø§ÛŒÙ†Ø¬Ø§ ØªØ§Ø¨Ø¹ÛŒ Ø§Ø³Øª Ú©Ù‡ Ù„ÛŒØ³Øª ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯\r\n\r\n      alert(\"âœ… ÙˆØ¶Ø¹ÛŒØª ÙØ§Ú©ØªÙˆØ± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªØºÛŒÛŒØ± Ú©Ø±Ø¯.\");\r\n    } catch (error) {\r\n      console.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª:\", error);\r\n      alert(\"âš ï¸ ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ù†Ø´Ø¯.\");\r\n    }\r\n  };\r\n\r\n  // Get Token from Local Storage\r\n  const token = localStorage.getItem(\"accessToken\");\r\n  if (!token) {\r\n    alert(\"â›” Ø®Ø·Ø§: Ø´Ù…Ø§ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯! Ø¨Ù‡ ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯ Ù‡Ø¯Ø§ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆÛŒØ¯.\");\r\n    navigate(\"/LoginForm\");\r\n    return;\r\n  }\r\n\r\n  // Get Order Factor\r\n\r\n  // Get Order Invoices\r\n\r\n  useEffect(() => {\r\n    if (id) getBillsOfLading(id);\r\n  }, [id]);\r\n\r\n  const getBillsOfLading = async (orderId) => {\r\n    console.log(\"Order ID:\", orderId);\r\n\r\n    try {\r\n      const response = await axios.get(\r\n        `https://amin-beton-back.chbk.app/api/orders/${orderId}/get-bills-of-lading/`,\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        }\r\n      );\r\n      console.log(\"API Response:\", response.data);\r\n      setBills(response.data); // Ù…Ø·Ù…Ø¦Ù† Ø´Ùˆ Ú©Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´Ù†\r\n    } catch (error) {\r\n      console.error(\"Error fetching bills of lading:\", error);\r\n    }\r\n  };\r\n\r\n  // Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª MapComponent\r\n\r\n  const fetchAndDownloadInvoice = async (orderId) => {\r\n    console.log(\"Order ID received:\", orderId); // Ú†Ø§Ù¾ Ù…Ù‚Ø¯Ø§Ø± orderId Ø¯Ø± Ú©Ù†Ø³ÙˆÙ„\r\n\r\n    if (!orderId || isNaN(orderId)) {\r\n      alert(\"âš ï¸ Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø´Ù†Ø§Ø³Ù‡ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await axios.post(\r\n        \"https://amin-beton-back.chbk.app/api/orders/get-order-invoices/\",\r\n        { order_id: parseInt(orderId) },\r\n        {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        }\r\n      );\r\n\r\n      console.log(\"API Response:\", response.data); // Ú†Ø§Ù¾ Ù¾Ø§Ø³Ø® API\r\n\r\n      const invoices = response.data;\r\n\r\n      if (!invoices || invoices.length === 0) {\r\n        alert(\"â›” Ù‡ÛŒÚ† Ù¾ÛŒØ´â€ŒÙØ§Ú©ØªÙˆØ±ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø³ÙØ§Ø±Ø´ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡.\");\r\n        return;\r\n      }\r\n\r\n      const invoice = invoices[0];\r\n\r\n      if (!invoice.invoice_file) {\r\n        alert(\"âš ï¸ Ù¾ÛŒØ´â€ŒÙØ§Ú©ØªÙˆØ± ÛŒØ§ÙØª Ø´Ø¯ Ø§Ù…Ø§ ÙØ§ÛŒÙ„ Ù†Ø¯Ø§Ø±Ø¯.\");\r\n        return;\r\n      }\r\n\r\n      // Ø§Ø¯Ø§Ù…Ù‡ Ú©Ø¯ Ø´Ù…Ø§...\r\n    } catch (error) {\r\n      console.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª ÙØ§Ú©ØªÙˆØ±Ù‡Ø§:\", error);\r\n      alert(\"âš ï¸ Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª ÛŒØ§ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù¾ÛŒØ´ Ø¢Ù…Ø¯.\");\r\n    }\r\n  };\r\n\r\n  // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª ÙØ§Ú©ØªÙˆØ±Ù‡Ø§\r\n  // const getInvoices = async () => {\r\n  //   try {\r\n  //     const response = await axios.get(\r\n  //       `https://amin-beton-back.chbk.app/api/orders/${id}/get-order-invoices/`,\r\n  //       {\r\n  //         headers: { Authorization: `Bearer ${token}` },\r\n  //       }\r\n  //     );\r\n  //     setInvoices(response.data); // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ù‡ Ø±ÙˆØ² Ù…ÛŒâ€ŒÚ©Ù†Ø¯\r\n  //   } catch (error) {\r\n  //     console.error(\"Error fetching invoices:\", error);\r\n  //   }\r\n  // };\r\n\r\n  const handleStatusButtonClick = (invoice) => {\r\n    const selectedStatus = invoiceStatuses[invoice.id];\r\n\r\n    // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡\r\n    if (!selectedStatus) {\r\n      alert(\"Ù„Ø·ÙØ§Ù‹ ÙˆØ¶Ø¹ÛŒØª Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.\");\r\n      return;\r\n    }\r\n\r\n    // Ø§Ú¯Ø± ÙˆØ¶Ø¹ÛŒØª \"Ø±Ø¯\" Ø¨Ø§Ø´Ø¯ØŒ Ø¨Ø§ÛŒØ¯ Ø¯Ù„ÛŒÙ„ Ø±Ø¯ ÙˆØ§Ø±Ø¯ Ø´ÙˆØ¯\r\n    if (selectedStatus === \"rejected\" && !denyReasons[invoice.id]) {\r\n      alert(\"Ù„Ø·ÙØ§Ù‹ Ø¯Ù„ÛŒÙ„ Ø±Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.\");\r\n      return;\r\n    }\r\n\r\n    // Ø¯Ø± ØºÛŒØ± Ø§ÛŒÙ† ØµÙˆØ±Øª ÙˆØ¶Ø¹ÛŒØª Ø±Ø§ ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ…\r\n    handleStatusChange(invoice.id, selectedStatus, denyReasons[invoice.id]);\r\n  };\r\n\r\n  // Get Lab Categories\r\n  const getCategories = async () => {\r\n    try {\r\n      const response = await axios.get(\r\n        \"https://amin-beton-back.chbk.app/api/lab-result-category/\",\r\n        {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        }\r\n      );\r\n      if (response.data) {\r\n        setCategories(response.data);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching categories:\", error);\r\n    }\r\n  };\r\n  // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² IMEI\r\n\r\n  // Approve/Reject Invoice\r\n\r\n  const downloadLabCategoriesReport = () => {\r\n    if (!categories || categories.length === 0) {\r\n      alert(\"âš ï¸ Ù‡ÛŒÚ† Ø§Ø·Ù„Ø§Ø¹Ø§ØªÛŒ Ø§Ø² Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯!\");\r\n      return;\r\n    }\r\n\r\n    let labContent = `ğŸ“š Lab Categories Report (Order ID: ${id})\\n=========================\\n`;\r\n    categories.forEach((cat) => {\r\n      labContent += `Category: ${cat.title}\\n`;\r\n      if (cat.tests && cat.tests.length > 0) {\r\n        labContent += \"Tests:\\n\";\r\n        cat.tests.forEach((test) => {\r\n          labContent += `  - ${test.name}\\n`;\r\n        });\r\n      } else {\r\n        labContent += \"  No tests available\\n\";\r\n      }\r\n      labContent += \"=========================\\n\";\r\n    });\r\n\r\n    const blob = new Blob([labContent], { type: \"text/plain\" });\r\n    const url = window.URL.createObjectURL(blob);\r\n\r\n    const link = document.createElement(\"a\");\r\n    link.href = url;\r\n    link.setAttribute(\"download\", `lab_categories_report_${id}.txt`);\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  };\r\n\r\n  const getStatusText = (status) => {\r\n    switch (status) {\r\n      case 1:\r\n        return \"Ø®Ø±ÛŒØ¯ Ø§ÙˆÙ„ÛŒÙ‡\";\r\n      case 2:\r\n        return \"Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù…ÛŒÙ† Ø¨ØªÙ†\";\r\n      case 3:\r\n        return \"ØµØ¯ÙˆØ± Ù¾ÛŒØ´ ÙØ§Ú©ØªÙˆØ±\";\r\n      case 4:\r\n        return \"ØªØ§ÛŒÛŒØ¯ Ù¾ÛŒØ´ ÙØ§Ú©ØªÙˆØ±\";\r\n      case 5:\r\n        return \"Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´\";\r\n      case 6:\r\n        return \"Ø¯Ø±ÛŒØ§ÙØª\";\r\n      case 7:\r\n        return \"Ø§ØªÙ…Ø§Ù… ÙØ±Ø¢ÛŒÙ†Ø¯\";\r\n      default:\r\n        return \"Ù†Ø§Ù…Ø´Ø®Øµ\";\r\n    }\r\n  };\r\n\r\n  const getLocation = async (imei) => {\r\n    try {\r\n      // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø³ØªÛŒ Ø¨Ø±Ø§ÛŒ Ù…ÙˆÙ‚Ø¹ÛŒØª\r\n      const locationData = {\r\n        latitude: 35.602496,\r\n        longitude: 51.308115,\r\n      };\r\n\r\n      // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ state Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø³ØªÛŒ\r\n      setLocation(locationData);\r\n\r\n      // Ø§Ú¯Ø± Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§Ø² axios Ù‡Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ØªØ³Øª:\r\n      // const response = await axios.post(\r\n      //   \"https://amin-beton-back.chbk.app/api/bills-of-lading-management/get-location/\",\r\n      //   { imei },\r\n      //   { headers: { Authorization: `Bearer ${token}` } }\r\n      // );\r\n      // if (response.data) {\r\n      //   setLocation(response.data); // Ù…ÙˆÙ‚Ø¹ÛŒØª Ø±Ø§ Ø¯Ø± state Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…\r\n      // }\r\n    } catch (error) {\r\n      console.error(\"Error fetching location:\", error);\r\n    }\r\n  };\r\n  const getInvoices = async () => {\r\n    try {\r\n      const orderId = 82;\r\n\r\n      // Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒØ³Øª Ø§ÛŒÙ†ÙˆÛŒØ³â€ŒÙ‡Ø§ Ø§Ø² API\r\n      const response = await axios.post(\r\n        \"https://amin-beton-back.chbk.app/api/orders/get-order-invoices/\",\r\n        {\r\n          order_id: orderId, // Ø§Ø±Ø³Ø§Ù„ order_id Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø¨Ø¯Ù†Ù‡ Ø¯Ø±Ø®ÙˆØ§Ø³Øª\r\n        },\r\n        {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`, // Ø§Ø±Ø³Ø§Ù„ ØªÙˆÚ©Ù† Ø¨Ø±Ø§ÛŒ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª\r\n          },\r\n        }\r\n      );\r\n\r\n      const invoices = response.data; // ÙØ±Ø¶ Ø¨Ø± Ø§ÛŒÙ†Ú©Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± invoices Ù‚Ø±Ø§Ø± Ø¯Ø§Ø±Ù†Ø¯\r\n\r\n      // Ø§Ú¯Ø± Ø§ÛŒÙ†ÙˆÛŒØ³â€ŒÙ‡Ø§ Ø®Ø§Ù„ÛŒ Ø¨ÙˆØ¯\r\n      if (!invoices || invoices.length === 0) {\r\n        alert(\"â›” Ù‡ÛŒÚ† Ø§ÛŒÙ†ÙˆÛŒØ³ÛŒ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯.\");\r\n        return;\r\n      }\r\n\r\n      // Ù†Ù…Ø§ÛŒØ´ Ù„ÛŒØ³Øª Ø§ÛŒÙ†ÙˆÛŒØ³â€ŒÙ‡Ø§ Ø¯Ø± Ú©Ù†Ø³ÙˆÙ„\r\n      console.log(\"Ù„ÛŒØ³Øª Ø§ÛŒÙ†ÙˆÛŒØ³â€ŒÙ‡Ø§:\", invoices);\r\n\r\n      // Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§ÛŒÙ†ÙˆÛŒØ³â€ŒÙ‡Ø§ Ø±Ø§ Ø¯Ø± UI Ù†Ù…Ø§ÛŒØ´ Ø¯Ù‡ÛŒØ¯ ÛŒØ§ Ù‡Ø± Ø¹Ù…Ù„ Ø¯ÛŒÚ¯Ø±ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯\r\n      invoices.forEach((invoice) => {\r\n        console.log(`Ø§ÛŒÙ†ÙˆÛŒØ³ ${invoice.id}:`, invoice);\r\n      });\r\n    } catch (error) {\r\n      // console.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§ÛŒÙ†ÙˆÛŒØ³â€ŒÙ‡Ø§:\", error);\r\n      // alert(\"âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§ÛŒÙ†ÙˆÛŒØ³â€ŒÙ‡Ø§.\");\r\n    }\r\n  };\r\n\r\n  // ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ ØªØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ\r\n  getInvoices();\r\n\r\n  // ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ ØªØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø§ÛŒÙ†ÙˆÛŒØ³â€ŒÙ‡Ø§\r\n  getInvoices();\r\n\r\n  // Ø¯Ø§Ø®Ù„ Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª HistoryProject\r\n  return (\r\n    <div className=\"min-h-screen bg-b-gray\">\r\n      <HeaderNav className=\"mx-auto\" />\r\n      <ProjectHeading />\r\n\r\n      <div className=\"container flex flex-row-reverse justify-between w-full gap-10 \">\r\n        <div className=\"flex flex-row\">\r\n          <div>\r\n            <ProgressCircle status={1} />{\" \"}\r\n            <p className=\"mt-2 text-center text-white\">\r\n              ÙˆØ¶Ø¹ÛŒØª: {getStatusText(1)}{\" \"}\r\n            </p>{\" \"}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex flex-col text-right \">\r\n          {/* âŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø±ÙˆÛŒ ØµÙØ­Ù‡ Ù…Ø®ÙÛŒ Ø´Ø¯ */}\r\n          {/* {factor && (...) } */}\r\n          {/* {invoices.map((invoice) => (...))} */}\r\n          {/* {categories.map((cat) => (...))} */}\r\n\r\n          {/* âœ… Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù‡Ù…Ú†Ù†Ø§Ù† Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯ */}\r\n          <div className=\"flex flex-col gap-2\">\r\n            <div className=\"py-10 border-b border-white \">\r\n              <p className=\"text-sm text-School-Bus md:text-base\">\r\n                Ø§Ø±Ø³Ø§Ù„ Ø§ÛŒÙ† Ø®Ø±ÛŒØ¯ Ø¯Ø± ØªØ§Ø±ÛŒØ® 1402/10/22 Ùˆ Ø³Ø§Ø¹Øª 12:30 Ø«Ø¨Øª Ø´Ø¯\r\n              </p>\r\n            </div>\r\n            <div className=\"py-10 border-b border-white\">\r\n              <button onClick={() => downloadFactorReport(id)}>\r\n                ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú¯Ø²Ø§Ø±Ø´ ÙØ§Ú©ØªÙˆØ±\r\n              </button>\r\n            </div>\r\n            <div className=\"py-10 border-b border-white bg-School-Bus\">\r\n              <button onClick={() => fetchAndDownloadInvoice(id)}>\r\n                ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù¾ÛŒØ´â€ŒÙØ§Ú©ØªÙˆØ±\r\n              </button>\r\n\r\n              {invoices.length === 0 ? (\r\n                <p>Ù‡ÛŒÚ† ÙØ§Ú©ØªÙˆØ±ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª.</p>\r\n              ) : (\r\n                invoices.map((invoice) => (\r\n                  <div\r\n                    key={invoice.id}\r\n                    style={{\r\n                      border: \"1px solid #ccc\",\r\n                      padding: \"10px\",\r\n                      margin: \"10px\",\r\n                    }}\r\n                  >\r\n                    <p>ğŸ’° Ù…Ø¨Ù„Øº: {invoice.price}</p>\r\n                    <p>\r\n                      ğŸ“„ ÙˆØ¶Ø¹ÛŒØª:{\" \"}\r\n                      {invoice.status === 1\r\n                        ? \"Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ§ÛŒÛŒØ¯\"\r\n                        : invoice.status === 2\r\n                        ? \"Ø±Ø¯ Ø´Ø¯Ù‡\"\r\n                        : \"ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡\"}\r\n                    </p>\r\n                    {invoice.status === 3 && invoice.deny_reason && (\r\n                      <p>ğŸ›‘ Ø¯Ù„ÛŒÙ„ Ø±Ø¯: {invoice.deny_reason}</p>\r\n                    )}\r\n                    {invoice.status === 1 && (\r\n                      <div>\r\n                        <select\r\n                          onChange={(e) =>\r\n                            setInvoiceStatuses((prev) => ({\r\n                              ...prev,\r\n                              [invoice.id]: e.target.value,\r\n                            }))\r\n                          }\r\n                        >\r\n                          <option value=\"\">-- Ø§Ù†ØªØ®Ø§Ø¨ ÙˆØ¶Ø¹ÛŒØª --</option>\r\n                          <option value=\"approved\">âœ… ØªØ§ÛŒÛŒØ¯</option>\r\n                          <option value=\"rejected\">âŒ Ø±Ø¯</option>\r\n                        </select>\r\n\r\n                        {invoiceStatuses[invoice.id] === \"rejected\" && (\r\n                          <input\r\n                            type=\"text\"\r\n                            placeholder=\"Ø¯Ù„ÛŒÙ„ Ø±Ø¯\"\r\n                            onChange={(e) =>\r\n                              setDenyReasons((prev) => ({\r\n                                ...prev,\r\n                                [invoice.id]: e.target.value,\r\n                              }))\r\n                            }\r\n                          />\r\n                        )}\r\n                        <div className=\"py-10 border-b border-white bg-School-Bus\">\r\n                          <button\r\n                            onClick={() => handleStatusButtonClick(invoice)}\r\n                          >\r\n                            Ø«Ø¨Øª ÙˆØ¶Ø¹ÛŒØª\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n            <button onClick={() => handleStatusChange()}>Ø«Ø¨Øª ÙˆØ¶Ø¹ÛŒØª</button>\r\n            <div className=\"py-10 border-b border-white\">\r\n              <ButtonProject\r\n                onClick={downloadLabCategoriesReport}\r\n                className=\"text-green-500\"\r\n              >\r\n                ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡\r\n              </ButtonProject>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"p-4 text-white bg-gray-800 rounded-lg\">\r\n        {\" \"}\r\n        <div className=\"grid grid-cols-1 gap-6 py-6 mt-4 md:grid-cols-2\">\r\n          {/* Ù†Ù…Ø§ÛŒØ´ Ø¨Ø§Ø±Ù†Ø§Ù…Ù‡â€ŒÙ‡Ø§ */}\r\n          <div className=\"grid grid-cols-1 gap-6 py-6 mt-4 md:grid-cols-2\">\r\n            {bills.map((bill) => (\r\n              <div\r\n                key={bill.id}\r\n                className=\"p-4 bg-gray-900 border border-gray-600 rounded-xl shadow-md flex flex-col gap-4 transition-all duration-300 hover:scale-[1.02]\"\r\n              >\r\n                <div className=\"flex flex-col items-start justify-between gap-6 md:flex-row md:items-center\">\r\n                  {/* Ø³Ù…Øª Ø±Ø§Ø³Øª: Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§Ø±Ù†Ø§Ù…Ù‡ */}\r\n                  <div className=\"flex flex-col w-full gap-4 md:w-1/2\">\r\n                    <div>\r\n                      <p className=\"mt-1 text-sm text-School-Bus\">Ø¯Ø± Ù…Ø³ÛŒØ±</p>\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-col gap-4 text-sm\">\r\n                      <div className=\"flex flex-col gap-2\">\r\n                        <p>\r\n                          Ù†Ø§Ù… Ø±Ø§Ù†Ù†Ø¯Ù‡:{\" \"}\r\n                          <span className=\"font-medium\">\r\n                            {bill.driver.driver_name}\r\n                          </span>\r\n                        </p>\r\n                        <p>\r\n                          <span className=\"font-medium\">\r\n                            Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø±Ø§Ù†Ù†Ø¯Ù‡:\r\n                            {bill.driver.driver_mobile}\r\n                          </span>\r\n                        </p>\r\n                        <p>\r\n                          Ø´Ù…Ø§Ø±Ù‡ Ø¨Ø§Ø±Ù†Ø§Ù…Ù‡:{\" \"}\r\n                          <span className=\"font-medium\">\r\n                            {bill.bill_of_lading_id}\r\n                          </span>\r\n                        </p>\r\n                        <p>\r\n                          Ø´Ù…Ø§Ø±Ù‡ Ù¾Ù„Ø§Ú©:{\" \"}\r\n                          <span className=\"font-medium\">\r\n                            {bill.driver.plate_number_2}{\" \"}\r\n                            {bill.driver.plate_number_alphabet}{\" \"}\r\n                            {bill.driver.plate_number_3} -{\" \"}\r\n                            {bill.driver.plate_number_iran}\r\n                          </span>\r\n                        </p>\r\n                      </div>\r\n\r\n                      <div className=\"flex flex-col gap-2\">\r\n                        <p>\r\n                          ØªØ§Ø±ÛŒØ® Ø¨Ø§Ø±Ù†Ø§Ù…Ù‡:{\" \"}\r\n                          <span className=\"font-medium\">\r\n                            {bill.bill_of_lading_date}\r\n                          </span>\r\n                        </p>\r\n                        <p>\r\n                          Ø²Ù…Ø§Ù† Ø¨Ø§Ø±Ù†Ø§Ù…Ù‡:{\" \"}\r\n                          <span className=\"font-medium\">\r\n                            {bill.bill_of_lading_time}\r\n                          </span>\r\n                        </p>\r\n                        <p>\r\n                          ÙˆØ²Ù† Ø®Ø§Ù„Øµ:{\" \"}\r\n                          <span className=\"font-medium\">\r\n                            {bill.net_weight} Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…\r\n                          </span>\r\n                        </p>\r\n                        <p>\r\n                          Ù…Ù‚ØµØ¯:{\" \"}\r\n                          <span className=\"font-medium\">\r\n                            {bill.destination}\r\n                          </span>\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Ø³Ù…Øª Ú†Ù¾: Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø³ØªÚ¯Ø§Ù‡ */}\r\n                  <div className=\"w-full md:w-1/2\">\r\n                    <p>\r\n                      ÙˆØ²Ù† Ø®Ø§Ù„ÛŒ:{\" \"}\r\n                      <span className=\"font-medium\">\r\n                        {bill.empty_weight} Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…\r\n                      </span>\r\n                    </p>\r\n                    <p>\r\n                      ÙˆØ²Ù† Ù¾Ø±:{\" \"}\r\n                      <span className=\"font-medium\">\r\n                        {bill.total_weight} Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…\r\n                      </span>\r\n                    </p>\r\n                    <p>\r\n                      ÙˆØ²Ù† Ø®Ø§Ù„Øµ:{\" \"}\r\n                      <span className=\"font-medium\">\r\n                        {bill.net_weight} Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…\r\n                      </span>\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <ButtonProject\r\n                  onClick={() => handleShowLocation(bill.device.IMEI)} // Ù‡Ù†Ú¯Ø§Ù… Ú©Ù„ÛŒÚ©ØŒ IMEI Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯\r\n                >\r\n                  {selectedImei === bill.device.IMEI\r\n                    ? \"ğŸ”„ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÙˆÙ‚Ø¹ÛŒØª\"\r\n                    : \"ğŸ“ Ù†Ù…Ø§ÛŒØ´ Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡\"}\r\n                </ButtonProject>\r\n                <div>\r\n                  {selectedImei === bill.device.IMEI && location && (\r\n                    <div className=\"mt-6\">\r\n                      <h3 className=\"text-lg font-semibold\">Ù…ÙˆÙ‚Ø¹ÛŒØª Ø±Ø§Ù†Ù†Ø¯Ù‡</h3>\r\n                      <MapComponent\r\n                        latitude={location.latitude}\r\n                        longitude={location.longitude}\r\n                        width=\"100%\"\r\n                        height=\"400px\"\r\n                      />\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HistoryProject;\r\n"
        }
    ]
}