{
    "sourceFile": "src/Sales/UserForm .jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1747687192452,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1747687231292,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,9 +128,9 @@\n         className=\"flex flex-col justify-center w-full h-full gap-8 px-6 py-10 text-white bg-Bokara-Grey\"\r\n       >\r\n         <div className=\"grid w-full grid-cols-1 gap-6 sm:grid-cols-2\">\r\n           {/* نام */}\r\n-          {/* <div className=\"flex flex-col gap-1\">\r\n+          <div className=\"flex flex-col gap-1\">\r\n             <label htmlFor=\"firstName\" className=\"text-lg font-medium\">\r\n               نام\r\n             </label>\r\n             <Input\r\n@@ -142,9 +142,9 @@\n             />\r\n             {errors.firstName && (\r\n               <span className=\"text-sm text-red\">{errors.firstName}</span>\r\n             )}\r\n-          </div> */}\r\n+          </div>\r\n \r\n           {/* نام خانوادگی */}\r\n           <div className=\"flex flex-col gap-1\">\r\n             <label htmlFor=\"lastName\" className=\"text-lg font-medium\">\r\n"
                },
                {
                    "date": 1747918079359,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -221,9 +221,9 @@\n \r\n         <div className=\"flex justify-center mt-6\">\r\n           <Button\r\n             type=\"submit\"\r\n-            className=\"w-full py-3 font-semibold text-gray-900 bg-yellow-500 rounded sm:w-1/4 hover:bg-yellow-400\"\r\n+            className=\"w-full py-3 font-semibold text-gray-900 bg-yellow-500 rounded hover:text-white sm:w-1/4 hover:bg-yellow-400\"\r\n           >\r\n             ثبت اطلاعات\r\n           </Button>\r\n         </div>\r\n"
                },
                {
                    "date": 1747918091739,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -221,9 +221,9 @@\n \r\n         <div className=\"flex justify-center mt-6\">\r\n           <Button\r\n             type=\"submit\"\r\n-            className=\"w-full py-3 font-semibold text-gray-900 bg-yellow-500 rounded hover:text-white sm:w-1/4 hover:bg-yellow-400\"\r\n+            className=\"w-full py-3  font-semibold text-gray-900 bg-yellow-500 rounded sm:w-1/4 hover:bg-yellow-400\"\r\n           >\r\n             ثبت اطلاعات\r\n           </Button>\r\n         </div>\r\n"
                }
            ],
            "date": 1747687192452,
            "name": "Commit-0",
            "content": "import React, { useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport Input from \"../ui/Input\";\r\nimport Button from \"../ui/Button\";\r\nimport logo from \"../assets/images/84c17d4db54552e3ecc58781c8cefc7a.png\";\r\n// import Modal from \"../pages/Modal\";\r\n\r\nconst UserForm = () => {\r\n  const navigate = useNavigate();\r\n\r\n  const [firstName, setFirstName] = useState(\"\");\r\n  const [lastName, setLastName] = useState(\"\");\r\n  const [nationalCode, setNationalCode] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [errors, setErrors] = useState({});\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [modalMessage, setModalMessage] = useState(\"\");\r\n\r\n  const validate = () => {\r\n    const newErrors = {};\r\n\r\n    // نام فقط باید حروف فارسی باشد\r\n    if (!firstName.trim()) {\r\n      newErrors.firstName = \"لطفاً نام خود را وارد کنید\";\r\n    } else if (!/^[\\u0600-\\u06FF\\s]+$/.test(firstName)) {\r\n      newErrors.firstName = \"نام باید فقط شامل حروف فارسی باشد\";\r\n    }\r\n\r\n    // نام خانوادگی فقط باید حروف فارسی باشد\r\n    if (!lastName.trim()) {\r\n      newErrors.lastName = \"لطفاً نام خانوادگی خود را وارد کنید\";\r\n    } else if (!/^[\\u0600-\\u06FF\\s]+$/.test(lastName)) {\r\n      newErrors.lastName = \"نام خانوادگی باید فقط شامل حروف فارسی باشد\";\r\n    }\r\n\r\n    // کد ملی باید 10 رقم باشد\r\n    if (!nationalCode.trim()) {\r\n      newErrors.nationalCode = \"لطفاً کد ملی خود را وارد کنید\";\r\n    } else if (!/^\\d{10}$/.test(nationalCode)) {\r\n      newErrors.nationalCode = \"کد ملی باید دقیقاً ۱۰ رقم باشد\";\r\n    }\r\n\r\n    // شماره موبایل باید با 09 شروع شده و 11 رقم باشد\r\n    if (!phone.trim()) {\r\n      newErrors.phone = \"لطفاً شماره موبایل خود را وارد کنید\";\r\n    } else if (!/^09\\d{9}$/.test(phone)) {\r\n      newErrors.phone = \"شماره موبایل باید با 09 شروع شده و ۱۱ رقم باشد\";\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n  const onClose = () => {\r\n    setShowModal(false);\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!validate()) return;\r\n\r\n    try {\r\n      const response = await axios.post(\r\n        \"https://amin-beton-back.chbk.app/api/users/register/\",\r\n        {\r\n          first_name: firstName,\r\n          last_name: lastName,\r\n          national_code: nationalCode,\r\n          phone: phone,\r\n        }\r\n      );\r\n\r\n      if (response.status === 200) {\r\n        setModalMessage(\"اطلاعات با موفقیت ثبت شد!\");\r\n        setShowModal(true);\r\n      }\r\n    } catch (error) {\r\n      if (error.response && error.response.status === 400) {\r\n        const serverErrors = error.response.data;\r\n        const formattedErrors = {};\r\n\r\n        if (serverErrors.first_name) {\r\n          formattedErrors.firstName = serverErrors.first_name.join(\" \");\r\n        }\r\n        if (serverErrors.last_name) {\r\n          formattedErrors.lastName = serverErrors.last_name.join(\" \");\r\n        }\r\n        if (serverErrors.national_code) {\r\n          formattedErrors.nationalCode = serverErrors.national_code.join(\" \");\r\n        }\r\n        if (serverErrors.phone) {\r\n          formattedErrors.phone = serverErrors.phone.join(\" \");\r\n        }\r\n\r\n        setErrors(formattedErrors);\r\n        setModalMessage(\r\n          \"مشکلی در ارتباط با سرور پیش آمده است، لطفاً مجدداً تلاش کنید.\"\r\n        );\r\n        setShowModal(true);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col justify-center w-full min-h-screen px-4 py-8 bg-Bokara-Grey\">\r\n      <div className=\"flex items-center justify-center gap-2 mb-4 text-4xl text-School-Bus\">\r\n        <span>امین</span>\r\n        <img className=\"h-14\" src={logo} alt=\"Company Logo\" />\r\n        <span>بتن</span>\r\n      </div>\r\n\r\n      {/* نمایش لیست کلی خطاها */}\r\n      {Object.keys(errors).length > 0 && (\r\n        <div className=\"p-4 mb-4 bg-red-100 border rounded-md text-red border-red\">\r\n          <h3 className=\"mb-2 text-lg font-semibold\">\r\n            لطفاً خطاهای زیر را برطرف کنید:\r\n          </h3>\r\n          <ul className=\"list-disc list-inside\">\r\n            {Object.values(errors).map((error, index) => (\r\n              <li key={index}>{error}</li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      )}\r\n\r\n      <form\r\n        onSubmit={handleSubmit}\r\n        className=\"flex flex-col justify-center w-full h-full gap-8 px-6 py-10 text-white bg-Bokara-Grey\"\r\n      >\r\n        <div className=\"grid w-full grid-cols-1 gap-6 sm:grid-cols-2\">\r\n          {/* نام */}\r\n          {/* <div className=\"flex flex-col gap-1\">\r\n            <label htmlFor=\"firstName\" className=\"text-lg font-medium\">\r\n              نام\r\n            </label>\r\n            <Input\r\n              id=\"firstName\"\r\n              className=\"p-2 text-right text-white bg-gray-700 border rounded placeholder:text-right focus:border-yellow-400\"\r\n              onChange={(e) => setFirstName(e.target.value)}\r\n              value={firstName}\r\n              placeholder=\"نام\"\r\n            />\r\n            {errors.firstName && (\r\n              <span className=\"text-sm text-red\">{errors.firstName}</span>\r\n            )}\r\n          </div> */}\r\n\r\n          {/* نام خانوادگی */}\r\n          <div className=\"flex flex-col gap-1\">\r\n            <label htmlFor=\"lastName\" className=\"text-lg font-medium\">\r\n              نام خانوادگی\r\n            </label>\r\n            <Input\r\n              id=\"lastName\"\r\n              className=\"p-2 text-right text-white bg-gray-700 border rounded placeholder:text-right focus:border-yellow-400\"\r\n              onChange={(e) => setLastName(e.target.value)}\r\n              value={lastName}\r\n              placeholder=\"نام خانوادگی\"\r\n            />\r\n            {errors.lastName && (\r\n              <span className=\"text-sm text-red\">{errors.lastName}</span>\r\n            )}\r\n          </div>\r\n\r\n          {/* کد ملی */}\r\n          <div className=\"flex flex-col gap-1\">\r\n            <label htmlFor=\"nationalCode\" className=\"text-lg font-medium\">\r\n              کد ملی\r\n            </label>\r\n            <Input\r\n              id=\"nationalCode\"\r\n              className=\"p-2 text-right text-white bg-gray-700 border rounded placeholder:text-right focus:border-yellow-400\"\r\n              onChange={(e) => setNationalCode(e.target.value)}\r\n              value={nationalCode}\r\n              placeholder=\"کد ملی\"\r\n            />\r\n            {errors.nationalCode && (\r\n              <span className=\"text-sm text-red\">{errors.nationalCode}</span>\r\n            )}\r\n          </div>\r\n\r\n          {/* شماره همراه */}\r\n          <div className=\"flex flex-col gap-1\">\r\n            <label htmlFor=\"phone\" className=\"text-lg font-medium\">\r\n              شماره همراه\r\n            </label>\r\n            <Input\r\n              id=\"phone\"\r\n              className=\"p-2 text-left text-white bg-gray-700 border rounded placeholder:text-right focus:border-yellow-400\"\r\n              onChange={(e) => setPhone(e.target.value)}\r\n              value={phone}\r\n              placeholder=\"شماره همراه\"\r\n              dir=\"ltr\"\r\n            />\r\n            {errors.phone && (\r\n              <span className=\"text-sm text-red\">{errors.phone}</span>\r\n            )}\r\n          </div>\r\n        </div>\r\n        {showModal && (\r\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60\">\r\n            <div className=\"relative p-8 text-white border-2 shadow-lg bg-Bokara-Grey border-School-Bus rounded-2xl w-96\">\r\n              <button\r\n                onClick={onClose}\r\n                className=\"absolute text-lg font-bold top-2 left-2 text-School-Bus\"\r\n              >\r\n                ×\r\n              </button>\r\n              <div className=\"flex flex-col items-center justify-center gap-4\">\r\n                <p className=\"text-center\">{modalMessage}</p>\r\n                <button\r\n                  onClick={() => setShowModal(false)}\r\n                  className=\"px-6 py-2 font-medium transition bg-School-Bus text-Bokara-Grey rounded-xl hover:opacity-90\"\r\n                >\r\n                  تایید\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"flex justify-center mt-6\">\r\n          <Button\r\n            type=\"submit\"\r\n            className=\"w-full py-3 font-semibold text-gray-900 bg-yellow-500 rounded sm:w-1/4 hover:bg-yellow-400\"\r\n          >\r\n            ثبت اطلاعات\r\n          </Button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserForm;\r\n"
        }
    ]
}