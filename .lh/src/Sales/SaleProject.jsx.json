{
    "sourceFile": "src/Sales/SaleProject.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1744179214908,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1744179834577,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -78,10 +78,15 @@\n     };\r\n \r\n     fetchData();\r\n   }, [navigate]);\r\n+  // const { id } = useParams();\r\n \r\n   useEffect(() => {\r\n+    fetchData(id);\r\n+  }, [id]); // Ø§ÛŒÙ†Ø¬Ø§ id ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒÚ©Ù†Ù‡ => useEffect Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´Ù‡\r\n+  \r\n+  useEffect(() => {\r\n     if (selectedDay) {\r\n       setIsTimeModalOpen(true); // ÙˆÙ‚ØªÛŒ ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯ØŒ Ù…ÙˆØ¯Ø§Ù„ Ø³Ø§Ø¹Øª Ø¨Ø§Ø² Ø´ÙˆØ¯\r\n     }\r\n   }, [selectedDay]);\r\n"
                },
                {
                    "date": 1744179872503,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -80,11 +80,9 @@\n     fetchData();\r\n   }, [navigate]);\r\n   // const { id } = useParams();\r\n \r\n-  useEffect(() => {\r\n-    fetchData(id);\r\n-  }, [id]); // Ø§ÛŒÙ†Ø¬Ø§ id ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒÚ©Ù†Ù‡ => useEffect Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´Ù‡\r\n+// Ø§ÛŒÙ†Ø¬Ø§ id ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒÚ©Ù†Ù‡ => useEffect Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´Ù‡\r\n \r\n   useEffect(() => {\r\n     if (selectedDay) {\r\n       setIsTimeModalOpen(true); // ÙˆÙ‚ØªÛŒ ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯ØŒ Ù…ÙˆØ¯Ø§Ù„ Ø³Ø§Ø¹Øª Ø¨Ø§Ø² Ø´ÙˆØ¯\r\n"
                },
                {
                    "date": 1744180054451,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -78,9 +78,9 @@\n     };\r\n \r\n     fetchData();\r\n   }, [navigate]);\r\n-  // const { id } = useParams();\r\n+  \r\n \r\n   // Ø§ÛŒÙ†Ø¬Ø§ id ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒÚ©Ù†Ù‡ => useEffect Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´Ù‡\r\n \r\n   useEffect(() => {\r\n"
                }
            ],
            "date": 1744179214908,
            "name": "Commit-0",
            "content": "import ButtonProject from \"../ui/ButtonProject\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport CustomCalendar from \"../ui/Calender\";\r\nimport Input from \"../ui/Input\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport jalaali from \"jalaali-js\";\r\n\r\nfunction SaleProject() {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const [isTimeModalOpen, setIsTimeModalOpen] = useState(false);\r\n  const [projectTitle, setProjectTitle] = useState(\"\");\r\n  const [selectedDay, setSelectedDay] = useState(null);\r\n  const [shift, setShift] = useState(1);\r\n  const [selectedTime, setSelectedTime] = useState(\"08:00\");\r\n  const [errors, setErrors] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [concreteTypes, setConcreteTypes] = useState([]);\r\n  const [concretePouringTypes, setConcretePouringTypes] = useState([]);\r\n  const [resistanceClasses, setResistanceClasses] = useState([]);\r\n  const [isModalOpen, setIsModalOpen] = useState(false); // Ø¨Ø±Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ø¨Ø§Ø² Ùˆ Ø¨Ø³ØªÙ‡ Ø´Ø¯Ù† Ù…ÙˆØ¯Ø§Ù„\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [newOrder, setNewOrder] = useState({\r\n    project: id || \"\",\r\n    concrete_type: \"\",\r\n    concrete_pouring_type: \"\",\r\n    concrete_area_size: \"\",\r\n    delivery_datetime: \"\",\r\n    shift: 1,\r\n    concrete_resistance_class: \"\",\r\n    max_pipeline_length: \"\",\r\n    pouring_height: \"\",\r\n  });\r\n\r\n  // Ú¯Ø±ÙØªÙ† Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯Ù†ÛŒØ§Ø²\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      const token = localStorage.getItem(\"accessToken\");\r\n      if (!token) {\r\n        toast.error(\"â›” Ø´Ù…Ø§ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯! Ù„Ø·ÙØ§Ù‹ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯.\");\r\n        navigate(\"/LoginForm\");\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const [typesRes, pouringRes, resistanceRes] = await Promise.all([\r\n          axios.get(\r\n            \"https://amin-beton-back.chbk.app/api/sales/concrete-list/\",\r\n            {\r\n              headers: { Authorization: `Bearer ${token}` },\r\n            }\r\n          ),\r\n          axios.get(\r\n            \"https://amin-beton-back.chbk.app/api/sales/concrete-pouring-type-list/\",\r\n            {\r\n              headers: { Authorization: `Bearer ${token}` },\r\n            }\r\n          ),\r\n          axios.get(\r\n            \"https://amin-beton-back.chbk.app/api/sales/concrete-resistance-class-list/\",\r\n            {\r\n              headers: { Authorization: `Bearer ${token}` },\r\n            }\r\n          ),\r\n        ]);\r\n\r\n        setConcreteTypes(typesRes.data);\r\n        setConcretePouringTypes(pouringRes.data);\r\n        setResistanceClasses(resistanceRes.data);\r\n      } catch (err) {\r\n        toast.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§!\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [navigate]);\r\n\r\n  useEffect(() => {\r\n    if (selectedDay) {\r\n      setIsTimeModalOpen(true); // ÙˆÙ‚ØªÛŒ ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯ØŒ Ù…ÙˆØ¯Ø§Ù„ Ø³Ø§Ø¹Øª Ø¨Ø§Ø² Ø´ÙˆØ¯\r\n    }\r\n  }, [selectedDay]);\r\n  const errorMessages = {\r\n    required: \"Ù¾Ø± Ú©Ø±Ø¯Ù† Ø§ÛŒÙ† ÙÛŒÙ„Ø¯ Ø§Ù„Ø²Ø§Ù…ÛŒ Ø§Ø³Øª.\",\r\n    minZero: \"Ù…Ù‚Ø¯Ø§Ø± Ø¨Ø§ÛŒØ¯ ØµÙØ± ÛŒØ§ Ø¨ÛŒØ´ØªØ± Ø¨Ø§Ø´Ø¯.\",\r\n    invalidDate: \"ÙØ±Ù…Øª ØªØ§Ø±ÛŒØ® Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª.\",\r\n    dateInPast: \"ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ø¨Ø§ÛŒØ¯ Ø§Ø² ØªØ§Ø±ÛŒØ® ÙØ¹Ù„ÛŒ Ø¨Ø²Ø±Ú¯ØªØ± Ø¨Ø§Ø´Ø¯.\",\r\n  };\r\n\r\n  // Ú¯Ø±ÙØªÙ† Ø¹Ù†ÙˆØ§Ù† Ù¾Ø±ÙˆÚ˜Ù‡\r\n  useEffect(() => {\r\n    const fetchProjectTitle = async () => {\r\n      const token = localStorage.getItem(\"accessToken\");\r\n      if (!token) {\r\n        toast.error(\"â›” Ø´Ù…Ø§ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯! Ù„Ø·ÙØ§Ù‹ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯.\");\r\n        navigate(\"/LoginForm\");\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await axios.get(\r\n          `https://amin-beton-back.chbk.app/api/projects/${id}`,\r\n          { headers: { Authorization: `Bearer ${token}` } }\r\n        );\r\n        setProjectTitle(response.data.title); // Ù…Ù‚Ø¯Ø§Ø± `title` Ø±Ø§ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†\r\n      } catch (error) {\r\n        console.error(\"Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¹Ù†ÙˆØ§Ù† Ù¾Ø±ÙˆÚ˜Ù‡:\", error);\r\n        toast.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø±ÙˆÚ˜Ù‡!\");\r\n      }\r\n    };\r\n\r\n    fetchProjectTitle();\r\n  }, [id, navigate]);\r\n\r\n  useEffect(() => {\r\n    console.log(\"ğŸ“… selectedDay:\", selectedDay);\r\n    console.log(\r\n      \"ğŸŒ™ shift:\",\r\n      shift === 2 ? \"Ø´Ø¨\" : shift === 1 ? \"Ø±ÙˆØ²\" : \"Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡\"\r\n    );\r\n    console.log(\"ğŸ•’ delivery_datetime:\", newOrder.delivery_datetime);\r\n  }, [selectedDay, shift, newOrder.delivery_datetime]);\r\n  // Ø²Ù…Ø§Ù†ÛŒ Ú©Ù‡ Ø³Ø§Ø¹Øª Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒØ´Ù‡\r\n  useEffect(() => {\r\n    if (!selectedDay) {\r\n      console.log(\"â— selectedDay Ø®Ø§Ù„ÛŒ Ø§Ø³Øª\");\r\n      return;\r\n    }\r\n\r\n    const { gy, gm, gd } = jalaali.toGregorian(\r\n      selectedDay.year,\r\n      selectedDay.month,\r\n      selectedDay.day\r\n    );\r\n\r\n    const currentDate = new Date(); // Ø§Ù„Ø§Ù†\r\n    const selectedDate = new Date(gy, gm - 1, gd); // ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡\r\n\r\n    const today = new Date(\r\n      currentDate.getFullYear(),\r\n      currentDate.getMonth(),\r\n      currentDate.getDate()\r\n    );\r\n\r\n    console.log(\"âœ… ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ÛŒ:\", selectedDate);\r\n\r\n    if (selectedDate < today) {\r\n      console.log(\"âŒ ØªØ§Ø±ÛŒØ® Ú¯Ø°Ø´ØªÙ‡ Ø§Ø³Øª\");\r\n\r\n      // Ø®Ø·Ø§: ØªØ§Ø±ÛŒØ® Ú¯Ø°Ø´ØªÙ‡\r\n      setErrorMessage(\"âŒ ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø§Ø² Ø§Ù…Ø±ÙˆØ² Ú¯Ø°Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯.\");\r\n      setIsModalOpen(true); // Ù…ÙˆØ¯Ø§Ù„ Ø®Ø·Ø§ Ø¨Ø§Ø² Ø¨Ø´Ù‡\r\n      setIsTimeModalOpen(false); // Ù…ÙˆØ¯Ø§Ù„ Ø³Ø§Ø¹Øª Ø­ØªÙ…Ø§Ù‹ Ø¨Ø³ØªÙ‡ Ø¨Ø´Ù‡\r\n\r\n      // Ø±ÛŒØ³Øª ØªØ§Ø±ÛŒØ® Ùˆ Ø³Ø§Ø¹Øª\r\n      setNewOrder((prev) => ({\r\n        ...prev,\r\n        delivery_datetime: \"\",\r\n      }));\r\n    } else {\r\n      console.log(\"âœ… ØªØ§Ø±ÛŒØ® Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª\");\r\n\r\n      // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø®Ø·Ø§Ù‡Ø§\r\n      setErrorMessage(\"\");\r\n      setIsModalOpen(false);\r\n\r\n      // Ù…ÙˆØ¯Ø§Ù„ Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø§Ø¹Øª Ø¨Ø§Ø² Ø¨Ø´Ù‡\r\n      setIsTimeModalOpen(true);\r\n    }\r\n  }, [selectedDay]);\r\n\r\n  // Ø²Ù…Ø§Ù†ÛŒ Ú©Ù‡ Ø³Ø§Ø¹Øª Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒØ´Ù‡\r\n  useEffect(() => {\r\n    if (!selectedDay || !selectedTime) {\r\n      console.log(\"â›” Ù…Ù†ØªØ¸Ø± Ø§Ù†ØªØ®Ø§Ø¨ ØªØ§Ø±ÛŒØ® Ùˆ Ø³Ø§Ø¹Øª...\");\r\n      return;\r\n    }\r\n\r\n    const { gy, gm, gd } = jalaali.toGregorian(\r\n      selectedDay.year,\r\n      selectedDay.month,\r\n      selectedDay.day\r\n    );\r\n\r\n    const formattedDate = `${gy}-${String(gm).padStart(2, \"0\")}-${String(\r\n      gd\r\n    ).padStart(2, \"0\")}T${selectedTime}`;\r\n\r\n    console.log(\"ğŸš€ delivery_datetime Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯:\", formattedDate);\r\n\r\n    // ğŸ‘‡ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú†Ú© Ø²Ù…Ø§Ù† ÙÙ‚Ø· Ø¯Ø± ØµÙˆØ±ØªÛŒ Ú©Ù‡ ØªØ§Ø±ÛŒØ® Ø§Ù…Ø±ÙˆØ² Ø¨Ø§Ø´Ù‡\r\n    const currentDate = new Date(); // Ø§Ù„Ø§Ù†\r\n    const selectedDate = new Date(gy, gm - 1, gd); // ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡\r\n\r\n    const today = new Date(\r\n      currentDate.getFullYear(),\r\n      currentDate.getMonth(),\r\n      currentDate.getDate()\r\n    );\r\n\r\n    const isToday = selectedDate.getTime() === today.getTime();\r\n\r\n    if (isToday) {\r\n      const currentHour = currentDate.getHours();\r\n      const currentMinute = currentDate.getMinutes();\r\n\r\n      const [selectedHour, selectedMinute] = selectedTime\r\n        .split(\":\")\r\n        .map(Number);\r\n\r\n      console.log(\"âŒš Ø²Ù…Ø§Ù† ÙØ¹Ù„ÛŒ:\", currentHour, currentMinute);\r\n      console.log(\"âœ… Ø²Ù…Ø§Ù† Ø§Ù†ØªØ®Ø§Ø¨ÛŒ:\", selectedHour, selectedMinute);\r\n\r\n      // Ø§Ú¯Ù‡ Ø³Ø§Ø¹Øª Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ú©Ù…ØªØ± ÛŒØ§ Ø¨Ø±Ø§Ø¨Ø± Ø¨Ø§ Ø³Ø§Ø¹Øª ÙØ¹Ù„ÛŒ Ø¨ÙˆØ¯ â†’ Ø®Ø·Ø§ Ø¨Ø¯Ù‡\r\n      if (\r\n        selectedHour < currentHour ||\r\n        (selectedHour === currentHour && selectedMinute <= currentMinute)\r\n      ) {\r\n        console.log(\"âŒ Ø³Ø§Ø¹Øª Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ú©Ù…ØªØ± Ø§Ø² Ø§Ù„Ø§Ù† Ø§Ø³Øª!\");\r\n\r\n        setErrorMessage(\"âŒ Ø³Ø§Ø¹Øª Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ú©Ù…ØªØ± Ø§Ø² Ø²Ù…Ø§Ù† ÙØ¹Ù„ÛŒ Ø¨Ø§Ø´Ø¯.\");\r\n        setIsModalOpen(true);\r\n\r\n        // Ø±ÛŒØ³Øª Ú©Ø±Ø¯Ù† datetime\r\n        setNewOrder((prev) => ({\r\n          ...prev,\r\n          delivery_datetime: \"\",\r\n        }));\r\n\r\n        return; // Ø§Ø¯Ø§Ù…Ù‡ Ù†Ø¯Ù‡!\r\n      }\r\n    }\r\n\r\n    // Ø³Øª Ú©Ø±Ø¯Ù† datetime Ù†Ù‡Ø§ÛŒÛŒ\r\n    setNewOrder((prev) => ({\r\n      ...prev,\r\n      delivery_datetime: formattedDate,\r\n    }));\r\n\r\n    // Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø¨Ø³ØªÙ‡ Ø¨ÙˆØ¯Ù† Ø®Ø·Ø§Ù‡Ø§\r\n    setErrorMessage(\"\");\r\n    setIsModalOpen(false);\r\n  }, [selectedTime]);\r\n  const handleConfirmTime = () => {\r\n    if (!selectedDay || !selectedTime) {\r\n      console.log(\"â›” ØªØ§Ø±ÛŒØ® ÛŒØ§ Ø³Ø§Ø¹Øª Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡\");\r\n      return;\r\n    }\r\n\r\n    const { gy, gm, gd } = jalaali.toGregorian(\r\n      selectedDay.year,\r\n      selectedDay.month,\r\n      selectedDay.day\r\n    );\r\n\r\n    const formattedDate = `${gy}-${String(gm).padStart(2, \"0\")}-${String(\r\n      gd\r\n    ).padStart(2, \"0\")}T${selectedTime}`;\r\n\r\n    const currentDate = new Date();\r\n    const selectedDate = new Date(gy, gm - 1, gd);\r\n    const selectedDateTime = new Date(\r\n      gy,\r\n      gm - 1,\r\n      gd,\r\n      ...selectedTime.split(\":\").map(Number)\r\n    );\r\n\r\n    const today = new Date(\r\n      currentDate.getFullYear(),\r\n      currentDate.getMonth(),\r\n      currentDate.getDate()\r\n    );\r\n\r\n    const isToday = selectedDate.getTime() === today.getTime();\r\n\r\n    // âœ… Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø³Ø§Ø¹Øª Ø¯Ø± Ù‡Ù…Ø§Ù† Ø±ÙˆØ²\r\n    if (isToday) {\r\n      const currentHour = currentDate.getHours();\r\n      const currentMinute = currentDate.getMinutes();\r\n\r\n      const [selectedHour, selectedMinute] = selectedTime\r\n        .split(\":\")\r\n        .map(Number);\r\n\r\n      if (\r\n        selectedHour < currentHour ||\r\n        (selectedHour === currentHour && selectedMinute <= currentMinute)\r\n      ) {\r\n        console.log(\"âŒ Ø³Ø§Ø¹Øª Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ú©Ù…ØªØ± Ø§Ø² Ø²Ù…Ø§Ù† ÙØ¹Ù„ÛŒ Ø§Ø³Øª!\");\r\n\r\n        setErrorMessage(\"âŒ Ø³Ø§Ø¹Øª Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ú©Ù…ØªØ± Ø§Ø² Ø²Ù…Ø§Ù† ÙØ¹Ù„ÛŒ Ø¨Ø§Ø´Ø¯.\");\r\n        setIsModalOpen(true);\r\n\r\n        // Ø±ÛŒØ³Øª Ú©Ù† Ú©Ù‡ Ø§Ú¯Ù‡ Ø®Ø·Ø§ Ø¯Ø§Ø¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¨ØªÙˆÙ†Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†Ù‡\r\n        setNewOrder((prev) => ({\r\n          ...prev,\r\n          delivery_datetime: \"\",\r\n        }));\r\n        return;\r\n      }\r\n    }\r\n\r\n    // âœ… Ø²Ù…Ø§Ù† Ù…Ø¹ØªØ¨Ø±Ù‡ â†’ Ø«Ø¨Øª Ú©Ù† Ùˆ Ù…ÙˆØ¯Ø§Ù„ Ø±Ùˆ Ø¨Ø¨Ù†Ø¯\r\n    setNewOrder((prev) => ({\r\n      ...prev,\r\n      delivery_datetime: formattedDate,\r\n    }));\r\n\r\n    setErrorMessage(\"\");\r\n    setIsModalOpen(false);\r\n    setIsTimeModalOpen(false);\r\n    console.log(\"ğŸš€ Ø²Ù…Ø§Ù† ØªØ­ÙˆÛŒÙ„ Ø«Ø¨Øª Ø´Ø¯:\", formattedDate);\r\n  };\r\n\r\n  // Ø¨Ø³ØªÙ† Ù…ÙˆØ¯Ø§Ù„ Ø®Ø·Ø§\r\n  const handleCloseModal = () => {\r\n    setIsModalOpen(false);\r\n    setErrorMessage(\"\");\r\n  };\r\n\r\n  // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙÛŒÙ„Ø¯Ù‡Ø§\r\n  const validateField = (field, value) => {\r\n    let error = \"\";\r\n\r\n    if (!value) {\r\n      error = errorMessages.required;\r\n    } else if (\r\n      [\"concrete_area_size\", \"max_pipeline_length\", \"pouring_height\"].includes(\r\n        field\r\n      )\r\n    ) {\r\n      if (isNaN(value) || Number(value) < 0) {\r\n        error = errorMessages.minZero;\r\n      }\r\n    } else if (field === \"delivery_datetime\") {\r\n      const selectedDate = new Date(value);\r\n      const now = new Date();\r\n      if (selectedDate <= now) {\r\n        error = errorMessages.dateInPast;\r\n      }\r\n    }\r\n\r\n    setErrors((prevErrors) => ({\r\n      ...prevErrors,\r\n      [field]: error,\r\n    }));\r\n\r\n    return error === \"\";\r\n  };\r\n\r\n  // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ ØªØ¨Ø¯ÛŒÙ„ Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ Ø¨Ù‡ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ\r\n  const convertToEnglishDigits = (input) => {\r\n    const persianDigits = [\"Û°\", \"Û±\", \"Û²\", \"Û³\", \"Û´\", \"Ûµ\", \"Û¶\", \"Û·\", \"Û¸\", \"Û¹\"];\r\n    const englishDigits = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\"];\r\n\r\n    return input\r\n      .split(\"\")\r\n      .map((char) => {\r\n        const index = persianDigits.indexOf(char);\r\n        return index !== -1 ? englishDigits[index] : char;\r\n      })\r\n      .join(\"\");\r\n  };\r\n\r\n  // Ø¯Ø±ÙˆÙ† handleChange Ø§Ø² Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯\r\n  const handleChange = (field, value) => {\r\n    // ØªØ¨Ø¯ÛŒÙ„ Ù…Ù‚Ø¯Ø§Ø± ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ Ø¨Ù‡ Ø§Ø¹Ø¯Ø§Ø¯ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ\r\n    const convertedValue = convertToEnglishDigits(value);\r\n\r\n    // Ø§Ø¯Ø§Ù…Ù‡ Ú©Ø¯ handleChange Ø¨Ø±Ø§ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ² Ú©Ø±Ø¯Ù† ÙˆØ¶Ø¹ÛŒØª (state)\r\n    setNewOrder({\r\n      ...newOrder,\r\n      [field]: convertedValue,\r\n    });\r\n  };\r\n\r\n  // ØªØºÛŒÛŒØ± Ù…Ù‚Ø¯Ø§Ø± ÙØ±Ù…\r\n\r\n  // Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù† Ø¬Ø§Ø±ÛŒ Ø±Ø§ Ù…ÛŒâ€ŒÚ¯ÛŒØ±ÛŒÙ…\r\n  const currentDateTime = new Date();\r\n\r\n  // ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ø¨Ù‡ Ø´ÛŒØ¡ Date Ø¨Ø±Ø§ÛŒ Ù…Ù‚Ø§ÛŒØ³Ù‡\r\n  const selectedDateTime = new Date(newOrder.delivery_datetime);\r\n\r\n  // Ù…Ù‚Ø§ÛŒØ³Ù‡ ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù†\r\n  if (selectedDateTime < currentDateTime) {\r\n    toast.error(\"âŒ ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù† Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø§Ø² Ø²Ù…Ø§Ù† Ø­Ø§Ù„ Ú¯Ø°Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯.\");\r\n    return;\r\n  }\r\n\r\n  // Ø§Ø±Ø³Ø§Ù„ ÙØ±Ù… Ø³ÙØ§Ø±Ø´\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    let formValid = true;\r\n    Object.keys(newOrder).forEach((field) => {\r\n      if (!validateField(field, newOrder[field])) {\r\n        formValid = false;\r\n      }\r\n    });\r\n\r\n    if (!formValid) {\r\n      toast.error(\"âš  Ù„Ø·ÙØ§Ù‹ Ø®Ø·Ø§Ù‡Ø§ÛŒ ÙØ±Ù… Ø±Ø§ Ø¨Ø±Ø·Ø±Ù Ú©Ù†ÛŒØ¯.\");\r\n      return;\r\n    }\r\n\r\n    const token = localStorage.getItem(\"accessToken\");\r\n    if (!token) {\r\n      toast.error(\"â›” Ø´Ù…Ø§ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯! Ù„Ø·ÙØ§Ù‹ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯.\");\r\n      navigate(\"/LoginForm\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await axios.post(\r\n        \"https://amin-beton-back.chbk.app/api/orders/\",\r\n        { ...newOrder, shift },\r\n        {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        }\r\n      );\r\n      console.log(\"Response from API:\", response); // Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø§Ø³Ø® Ú©Ù„ÛŒ Ø§Ø² Ø³Ø±ÙˆØ±\r\n      console.log(\"Order ID from response:\", response.data.id); // Ø¨Ø±Ø±Ø³ÛŒ id Ú©Ù‡ Ø§Ø² Ø³Ø±ÙˆØ± Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯Ù‡ Ø§Ø³Øª\r\n      navigate(`/PumpPage/${response.data.id}`); // Ù‡Ø¯Ø§ÛŒØª Ø¨Ù‡ ØµÙØ­Ù‡\r\n    } catch (error) {\r\n      console.error(\"Ø®Ø·Ø§ÛŒ Ø³Ø±ÙˆØ±:\", error); // Ø¨Ø±Ø±Ø³ÛŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±Ø®ÙˆØ§Ø³Øª\r\n    }\r\n  };\r\n\r\n  // Ø§Ú¯Ø± Ù„ÙˆØ¯ÛŒÙ†Ú¯ Ø¨ÙˆØ¯...\r\n  if (loading) {\r\n    return (\r\n      <div className=\"py-5 text-center text-white\">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen p-8 bg-gray-100 bg-Bokara-Grey\">\r\n      <h2 className=\"pt-10 mb-4 text-xl text-center text-white md:text-2xl\">\r\n        Ø®Ø±ÛŒØ¯ Ø¨Ø±Ø§ÛŒ\r\n        <p>{projectTitle || \"Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¹Ù†ÙˆØ§Ù† Ù¾Ø±ÙˆÚ˜Ù‡...\"}</p>\r\n      </h2>\r\n\r\n      <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\r\n        {/* Ù†ÙˆØ¹ Ø¨ØªÙ† */}\r\n        <div>\r\n          <label className=\"block text-white\">Ù†ÙˆØ¹ Ø¨ØªÙ†</label>\r\n          <select\r\n            value={newOrder.concrete_type}\r\n            onChange={(e) => handleChange(\"concrete_type\", e.target.value)}\r\n            className=\"w-full p-2 pl-4 text-white border bg-Bokara-Grey\"\r\n          >\r\n            <option value=\"\">Ø§Ù†ØªØ®Ø§Ø¨ Ù†ÙˆØ¹ Ø¨ØªÙ†</option>\r\n            {concreteTypes.map((type) => (\r\n              <option key={type.id} value={type.id}>\r\n                {type.title}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          {errors.concrete_type && (\r\n            <p className=\"text-red\">{errors.concrete_type}</p>\r\n          )}\r\n        </div>\r\n\r\n        {/* Ù…Ù‚Ø·Ø¹ Ø¨ØªÙ†â€ŒØ±ÛŒØ²ÛŒ */}\r\n        <div>\r\n          <label className=\"block text-white\">Ù…Ù‚Ø·Ø¹ Ø¨ØªÙ†â€ŒØ±ÛŒØ²ÛŒ</label>\r\n          <select\r\n            value={newOrder.concrete_pouring_type}\r\n            onChange={(e) =>\r\n              handleChange(\"concrete_pouring_type\", e.target.value)\r\n            }\r\n            className=\"w-full p-2 pl-4 text-white border bg-Bokara-Grey\"\r\n          >\r\n            <option value=\"\">Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ù‚Ø·Ø¹ Ø¨ØªÙ†â€ŒØ±ÛŒØ²ÛŒ</option>\r\n            {concretePouringTypes.map((pouring) => (\r\n              <option key={pouring.id} value={pouring.id}>\r\n                {pouring.title}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          {errors.concrete_pouring_type && (\r\n            <p className=\"text-red\">{errors.concrete_pouring_type}</p>\r\n          )}\r\n        </div>\r\n\r\n        {/* Ø±Ø¯Ù‡ Ù…Ù‚Ø§ÙˆÙ…Øª Ø¨ØªÙ† */}\r\n        {/* Ø±Ø¯Ù‡ Ù…Ù‚Ø§ÙˆÙ…Øª Ø¨ØªÙ† */}\r\n        <div>\r\n          <label className=\"block text-white\">Ø±Ø¯Ù‡ Ù…Ù‚Ø§ÙˆÙ…Øª Ø¨ØªÙ†</label>\r\n          <select\r\n            value={newOrder.concrete_resistance_class}\r\n            onChange={(e) =>\r\n              handleChange(\"concrete_resistance_class\", e.target.value)\r\n            }\r\n            className=\"w-full p-2 pl-4 text-white border bg-Bokara-Grey\"\r\n          >\r\n            <option value=\"\">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù„Ø§Ø³ Ù…Ù‚Ø§ÙˆÙ…Øª Ø¨ØªÙ†</option>\r\n            {resistanceClasses.map((cls) => (\r\n              <option key={cls.id} value={cls.id}>\r\n                {cls.title}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          {errors.concrete_resistance_class && (\r\n            <p className=\"text-red\">{errors.concrete_resistance_class}</p>\r\n          )}\r\n        </div>\r\n\r\n        {/* Ù…ØªØ±Ø§Ú˜ Ø¨ØªÙ† */}\r\n        <div>\r\n          <label className=\"block mb-1 text-white\">Ù…ØªØ±Ø§Ú˜ Ø¨ØªÙ† (Ù…ØªØ±Ù…Ú©Ø¹Ø¨)</label>\r\n          <Input\r\n            type=\"number\"\r\n            name=\"concrete_area_size\"\r\n            value={newOrder.concrete_area_size}\r\n            onChange={(e) => handleChange(\"concrete_area_size\", e.target.value)}\r\n            className=\"w-full p-2 border border-gray-300 rounded\"\r\n          />\r\n          {errors.concrete_area_size && (\r\n            <p className=\"mt-1 text-sm text-red\">{errors.concrete_area_size}</p>\r\n          )}\r\n        </div>\r\n\r\n        {/* Ø­Ø¯Ø§Ú©Ø«Ø± Ø·ÙˆÙ„ Ù„ÙˆÙ„Ù‡ Ú©Ø´ÛŒ */}\r\n        <div>\r\n          <label className=\"block mb-1 text-white\">\r\n            Ø­Ø¯Ø§Ú©Ø«Ø± Ù…ØªØ±Ø§Ú˜ Ù„ÙˆÙ„Ù‡â€ŒÚ©Ø´ÛŒ (Ù…ØªØ±)\r\n          </label>\r\n          <Input\r\n            type=\"number\"\r\n            value={newOrder.max_pipeline_length}\r\n            onChange={(e) =>\r\n              handleChange(\"max_pipeline_length\", e.target.value)\r\n            }\r\n            className=\"w-full p-2 border border-gray-300 rounded\"\r\n          />\r\n          {errors.max_pipeline_length && (\r\n            <p className=\"mt-1 text-sm text-red\">\r\n              {errors.max_pipeline_length}\r\n            </p>\r\n          )}\r\n        </div>\r\n\r\n        {/* Ø§Ø±ØªÙØ§Ø¹ Ø¨ØªÙ†â€ŒØ±ÛŒØ²ÛŒ */}\r\n        <div>\r\n          <label className=\"block mb-1 text-white\">\r\n            Ø§Ø±ØªÙØ§Ø¹ Ø¨ØªÙ†â€ŒØ±ÛŒØ²ÛŒ Ø§Ø² Ù…Ø­Ù„ Ù¾Ù…Ù¾ (Ù…ØªØ±)\r\n          </label>\r\n          <Input\r\n            type=\"number\"\r\n            value={newOrder.pouring_height}\r\n            onChange={(e) => handleChange(\"pouring_height\", e.target.value)}\r\n            className=\"w-full p-2 border border-gray-300 rounded\"\r\n          />\r\n          {errors.pouring_height && (\r\n            <p className=\"mt-1 text-sm text-red\">{errors.pouring_height}</p>\r\n          )}\r\n        </div>\r\n\r\n        {/* ØªÙ‚ÙˆÛŒÙ… Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø§Ø¹Øª */}\r\n        <div className=\"flex items-center justify-center w-full mt-4\">\r\n          <CustomCalendar\r\n            selectedDay={selectedDay}\r\n            setSelectedDay={setSelectedDay}\r\n            shift={shift}\r\n            setShift={setShift}\r\n          />\r\n        </div>\r\n\r\n        {/* Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø§Ø¹Øª */}\r\n        {isTimeModalOpen && (\r\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\">\r\n            <div className=\"relative z-50 flex flex-col items-center justify-center p-6 rounded-lg shadow-lg bg-Bokara-Grey\">\r\n              <h2 className=\"mb-4 text-lg text-white\">Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø§Ø¹Øª ØªØ­ÙˆÛŒÙ„</h2>\r\n              <input\r\n                type=\"time\"\r\n                value={selectedTime}\r\n                onChange={(e) => setSelectedTime(e.target.value)}\r\n                className=\"w-full p-2 border border-gray-300 rounded\"\r\n              />\r\n              <div className=\"flex justify-end mt-4\">\r\n                <button\r\n                  onClick={handleConfirmTime}\r\n                  className=\"px-4 py-2 bg-blue-500 rounded text-School-Bus\"\r\n                >\r\n                  ØªØ§ÛŒÛŒØ¯\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Ù†Ù…Ø§ÛŒØ´ Ø§Ø±ÙˆØ± Ú©Ù„ÛŒ */}\r\n        {isModalOpen && (\r\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\">\r\n            <div className=\"relative z-50 p-6 rounded-lg bg-red\">\r\n              <h2 className=\"text-white\">{errorMessage}</h2>\r\n              <button\r\n                onClick={handleCloseModal}\r\n                className=\"px-4 py-2 mt-4 text-white rounded bg-School-Bus\"\r\n              >\r\n                Ø¨Ø³ØªÙ†\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Ø¯Ú©Ù…Ù‡ Ø§Ø¯Ø§Ù…Ù‡ */}\r\n        <div className=\"flex items-center justify-center\">\r\n          <ButtonProject\r\n            type=\"submit\"\r\n            className=\"w-full py-2 mt-8 md:w-2/3 md:px-40\"\r\n          >\r\n            Ø§Ø¯Ø§Ù…Ù‡\r\n          </ButtonProject>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SaleProject;\r\n"
        }
    ]
}