{
    "sourceFile": "src/Sales/VibratorPage.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1744122429557,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1744123048581,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -151,16 +151,24 @@\n \r\n       // Ø§Ú¯Ø± Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯\r\n       if (response.status === 200) {\r\n         console.log(\"âœ… Server Response:\", response.data);\r\n-        toast.success(\"âœ” Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯!\");\r\n-\r\n-        // Ø±ÛŒÙ„ÙˆØ¯ ØµÙØ­Ù‡\r\n-        location.reload(); // ØµÙØ­Ù‡ Ø±Ø§ Ø±ÛŒÙ„ÙˆØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯\r\n+        toast.success(\"âœ” Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯!\");\r\n+      \r\n+        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡\r\n+        setSelectedVibrators((prev) => [...prev, ...newVibrators]);\r\n+        setSelectedSubVibrators((prev) => [...prev, ...newSubVibrators]);\r\n+      \r\n+        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙ‚Øª\r\n+        setTempSelectedVibrators([]);\r\n+        setTempSelectedSubVibrators([]);\r\n+        setSubVibrators([]);\r\n+        setQuantity(1);\r\n       } else {\r\n         setModalMessage(\"âŒ Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…Ø´Ú©Ù„ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯!\");\r\n-        setIsModalOpen(true);\r\n+        setIsModalOpen(true); // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù…ÙˆØ¯Ø§Ù„ Ø®Ø·Ø§\r\n       }\r\n+      \r\n     } catch (error) {\r\n       // Ø¯Ø± ØµÙˆØ±Øª Ø¨Ø±ÙˆØ² Ø®Ø·Ø§\r\n       console.error(\"âŒ Error Sending Request:\", error.response?.data || error);\r\n       setModalMessage(\r\n"
                },
                {
                    "date": 1744123194566,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -152,22 +152,29 @@\n       // Ø§Ú¯Ø± Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯\r\n       if (response.status === 200) {\r\n         console.log(\"âœ… Server Response:\", response.data);\r\n         toast.success(\"âœ” Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯!\");\r\n-\r\n-        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡\r\n-        setSelectedVibrators((prev) => [...prev, ...newVibrators]);\r\n-        setSelectedSubVibrators((prev) => [...prev, ...newSubVibrators]);\r\n-\r\n-        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙ‚Øª\r\n+      \r\n+        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ Ø¨Ø¯ÙˆÙ† Ø±ÙØ±Ø´ ØµÙØ­Ù‡\r\n+        setSelectedVibrators((prev) => {\r\n+          // Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒÙ… ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒÙ…\r\n+          return [...prev, ...newVibrators];\r\n+        });\r\n+        setSelectedSubVibrators((prev) => {\r\n+          // Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒÙ… Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒÙ…\r\n+          return [...prev, ...newSubVibrators];\r\n+        });\r\n+      \r\n+        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙ‚Øª Ø¨Ø¹Ø¯ Ø§Ø² Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù†\r\n         setTempSelectedVibrators([]);\r\n         setTempSelectedSubVibrators([]);\r\n         setSubVibrators([]);\r\n         setQuantity(1);\r\n       } else {\r\n         setModalMessage(\"âŒ Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…Ø´Ú©Ù„ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯!\");\r\n         setIsModalOpen(true); // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù…ÙˆØ¯Ø§Ù„ Ø®Ø·Ø§\r\n       }\r\n+      \r\n     } catch (error) {\r\n       // Ø¯Ø± ØµÙˆØ±Øª Ø¨Ø±ÙˆØ² Ø®Ø·Ø§\r\n       console.error(\"âŒ Error Sending Request:\", error.response?.data || error);\r\n       setModalMessage(\r\n"
                },
                {
                    "date": 1744123250324,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -733,70 +733,69 @@\n           </div>\r\n         )}\r\n         {/* Ù†Ù…Ø§ÛŒØ´ Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± */}\r\n         <div className=\"mb-8\">\r\n-          <h3 className=\"text-lg font-bold\">\r\n-            ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ø«Ø¨Øªâ€ŒØ´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø³ÙØ§Ø±Ø´\r\n-          </h3>\r\n-          <div className=\"flex flex-row flex-wrap gap-6 mt-4\">\r\n-            {selectedVibrators.map((vibrator) => {\r\n-              if (!vibrator.vibrator || !vibrator.vibrator.title) {\r\n-                return null;\r\n-              }\r\n+  <h3 className=\"text-lg font-bold\">\r\n+    ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ø«Ø¨Øªâ€ŒØ´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø³ÙØ§Ø±Ø´\r\n+  </h3>\r\n+  <div className=\"flex flex-row flex-wrap gap-6 mt-4\">\r\n+    {selectedVibrators.map((vibrator) => {\r\n+      if (!vibrator.vibrator || !vibrator.vibrator.title) {\r\n+        return null;\r\n+      }\r\n \r\n-              // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø²ÛŒØ±ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù‡Ø± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±\r\n-              const subVibratorsForThis = vibrator.sub_vibrator\r\n-                ? [vibrator.sub_vibrator]\r\n-                : [];\r\n+      // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø²ÛŒØ±ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù‡Ø± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±\r\n+      const subVibratorsForThis = vibrator.sub_vibrator\r\n+        ? [vibrator.sub_vibrator]\r\n+        : [];\r\n \r\n-              return (\r\n-                <div\r\n-                  key={vibrator.id}\r\n-                  className=\"flex flex-col items-center justify-center w-40 gap-2 px-4 py-4 text-center border rounded-lg border-School-Bus\"\r\n-                >\r\n-                  <div className=\"w-4 h-4 mb-2 rounded-full bg-School-Bus\"></div>\r\n-                  <div className=\"mb-2\">\r\n-                    {vibrator.vibrator?.title || \"ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ù†Ø§Ù…Ø´Ø®Øµ\"}\r\n-                  </div>\r\n-                  <div>ØªØ¹Ø¯Ø§Ø¯ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±: {vibrator.count}</div>\r\n-                  {subVibratorsForThis.length > 0 && (\r\n-                    <div>\r\n-                      {subVibratorsForThis.map((sub_vibrator) => (\r\n-                        <div key={sub_vibrator.id} className=\"text-sm\">\r\n-                          Ø²ÛŒØ±ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±: {sub_vibrator.title}\r\n-                        </div>\r\n-                      ))}\r\n-                    </div>\r\n-                  )}\r\n-                  <button\r\n-                    className=\"border-none text-red\"\r\n-                    onClick={() => handleDeleteVibratorOrder(vibrator.id)}\r\n-                  >\r\n-                    Ø­Ø°Ù\r\n-                  </button>\r\n+      return (\r\n+        <div\r\n+          key={vibrator.id}\r\n+          className=\"flex flex-col items-center justify-center w-40 gap-2 px-4 py-4 text-center border rounded-lg border-School-Bus\"\r\n+        >\r\n+          <div className=\"w-4 h-4 mb-2 rounded-full bg-School-Bus\"></div>\r\n+          <div className=\"mb-2\">\r\n+            {vibrator.vibrator?.title || \"ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ù†Ø§Ù…Ø´Ø®Øµ\"}\r\n+          </div>\r\n+          <div>ØªØ¹Ø¯Ø§Ø¯ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±: {vibrator.count}</div>\r\n+          {subVibratorsForThis.length > 0 && (\r\n+            <div>\r\n+              {subVibratorsForThis.map((sub_vibrator) => (\r\n+                <div key={sub_vibrator.id} className=\"text-sm\">\r\n+                  Ø²ÛŒØ±ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±: {sub_vibrator.title}\r\n                 </div>\r\n-              );\r\n-            })}\r\n-          </div>\r\n-\r\n-          <Button\r\n-            className=\"px-10\"\r\n-            onClick={() => {\r\n-              handleUpdateOrder();\r\n-              handleAddAndSubmit();\r\n-\r\n-              // navigate(`/FormPage/${orderId}`); // ÛŒØ§ Ù‡Ø± Ù…Ø³ÛŒØ± Ù…Ø±Ø­Ù„Ù‡â€ŒÛŒ Ø¨Ø¹Ø¯ÛŒ Ú©Ù‡ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø§Ø´Ù‡\r\n-            }}\r\n+              ))}\r\n+            </div>\r\n+          )}\r\n+          <button\r\n+            className=\"border-none text-red\"\r\n+            onClick={() => handleDeleteVibratorOrder(vibrator.id)}\r\n           >\r\n-            Ø§Ø¯Ø§Ù…Ù‡\r\n-          </Button>\r\n-          <Modal\r\n-            isOpen={isModalOpen}\r\n-            onClose={() => setIsModalOpen(false)}\r\n-            message={modalMessage}\r\n-          />\r\n+            Ø­Ø°Ù\r\n+          </button>\r\n         </div>\r\n+      );\r\n+    })}\r\n+  </div>\r\n \r\n+  <Button\r\n+    className=\"px-10\"\r\n+    onClick={() => {\r\n+      handleUpdateOrder();\r\n+      handleAddAndSubmit();\r\n+    }}\r\n+  >\r\n+    Ø§Ø¯Ø§Ù…Ù‡\r\n+  </Button>\r\n+  <Modal\r\n+    isOpen={isModalOpen}\r\n+    onClose={() => setIsModalOpen(false)}\r\n+    message={modalMessage}\r\n+  />\r\n+</div>\r\n+\r\n+\r\n         {showVibratorModal && (\r\n           <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\">\r\n             <div className=\"p-8 text-black bg-white rounded-lg w-96\">\r\n               <h2 className=\"mb-4 text-lg font-bold text-center\">\r\n"
                }
            ],
            "date": 1744122429557,
            "name": "Commit-0",
            "content": "// export default Vibrator\r\nimport React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport Button from \"../ui/Button\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport Modal from \"../pages/Modal\";\r\nconst VibratorPage = () => {\r\n  const [vibrators, setVibrators] = useState([]); // Ù„ÛŒØ³Øª ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§\r\n  const [subVibrators, setSubVibrators] = useState([]); // Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§\r\n  const [selectedVibrators, setSelectedVibrators] = useState([]); // ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡\r\n  const [selectedSubVibrators, setSelectedSubVibrators] = useState([]); // Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡\r\n  const [loading, setLoading] = useState(true); // Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒØŸ\r\n  const [tempSelectedVibrators, setTempSelectedVibrators] = useState([]); // ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡ Ù…ÙˆÙ‚Øª\r\n  const [tempSelectedSubVibrators, setTempSelectedSubVibrators] = useState([]); // Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡ Ù…ÙˆÙ‚Øª\r\n  const { orderId } = useParams(); // Ø´Ù…Ø§Ø±Ù‡ Ø³ÙØ§Ø±Ø´\r\n  const [projectTitle, setProjectTitle] = useState(\"\"); // Ø¹Ù†ÙˆØ§Ù† Ù¾Ø±ÙˆÚ˜Ù‡\r\n  const navigate = useNavigate(); // Ø¨Ø±Ø§ÛŒ Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ\r\n  const [malepSelected, setMalepSelected] = useState(\"\"); // Ù…Ø§Ù„Ù‡ Ù¾Ø±ÙˆØ§Ù†Ù‡\r\n  const [quantity, setQuantity] = useState(1); // ØªØ¹Ø¯Ø§Ø¯ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§\r\n  const [isSubmitting, setIsSubmitting] = useState(false); // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø§Ø±Ø³Ø§Ù„\r\n  const [showVibratorModal, setShowVibratorModal] = useState(false); // Ù†Ù…Ø§ÛŒØ´ Ù…Ø¯Ø§Ù„ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±\r\n  const [showVibratorSelection, setShowVibratorSelection] = useState(false); // Ù†Ù…Ø§ÛŒØ´ Ø§Ù†ØªØ®Ø§Ø¨ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±\r\n  const [supervisionSelected, setSupervisionSelected] = useState(null); // Ù†Ø¸Ø§Ø±Øª Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡\r\n  const [supervisionDescription, setSupervisionDescription] = useState(\"\");\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [modalMessage, setModalMessage] = useState(\"\");\r\n  const handleVibratorSelection = (id) => {\r\n    if (quantity < 1) {\r\n      toast.warn(\"âš ï¸ Ù„Ø·ÙØ§Ù‹ ØªØ¹Ø¯Ø§Ø¯ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!\");\r\n      return;\r\n    }\r\n\r\n    const vibrator = vibrators.find((v) => v.id === id);\r\n    if (!vibrator) return;\r\n\r\n    const isSelected = tempSelectedVibrators.some((v) => v.id === vibrator.id);\r\n\r\n    if (isSelected) {\r\n      // Ø§Ú¯Ø± Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ú©Ù„ÛŒÚ© Ú©Ø±Ø¯ØŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø±Ùˆ Ø­Ø°Ù Ú©Ù†\r\n      setTempSelectedVibrators([]);\r\n      setTempSelectedSubVibrators([]);\r\n      setSubVibrators([]);\r\n    } else {\r\n      // Ù‡Ø± Ø§Ù†ØªØ®Ø§Ø¨ Ù‚Ø¨Ù„ÛŒ Ø±Ùˆ Ø­Ø°Ù Ú©Ù† Ùˆ ÙÙ‚Ø· Ø§ÛŒÙ† ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†\r\n      setTempSelectedVibrators([\r\n        {\r\n          ...vibrator,\r\n          count: quantity,\r\n        },\r\n      ]);\r\n\r\n      setTempSelectedSubVibrators([]); // Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ù¾Ø§Ú© Ø¨Ø´Ù‡\r\n      setSubVibrators([]);\r\n      fetchSubVibrators(id);\r\n    }\r\n\r\n    // Ø°Ø®ÛŒØ±Ù‡ Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§ Ø¯Ø± localStorage\r\n    localStorage.setItem(\r\n      \"tempSelectedVibrators\",\r\n      JSON.stringify(tempSelectedVibrators)\r\n    );\r\n    localStorage.setItem(\r\n      \"tempSelectedSubVibrators\",\r\n      JSON.stringify(tempSelectedSubVibrators)\r\n    );\r\n  };\r\n\r\n  //   // Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø² localStorage\r\n  //   const savedSupervisionSelected = localStorage.getItem(\r\n  //     \"supervisionSelected\"\r\n  //   );\r\n  //   const savedMalepSelected = localStorage.getItem(\"malepSelected\");\r\n  //   const savedQuantity = localStorage.getItem(\"quantity\");\r\n  //   const savedSupervisionDescription = localStorage.getItem(\r\n  //     \"supervisionDescription\"\r\n  //   );\r\n\r\n  //   // ØªÙ†Ø¸ÛŒÙ… ÙˆØ¶Ø¹ÛŒØª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ´Ø¯Ù‡\r\n  //   if (savedSupervisionSelected) {\r\n  //     setSupervisionSelected(savedSupervisionSelected);\r\n  //   }\r\n  //   if (savedMalepSelected) {\r\n  //     setMalepSelected(savedMalepSelected);\r\n  //   }\r\n  //   if (savedQuantity) {\r\n  //     setQuantity(Number(savedQuantity));\r\n  //   }\r\n  //   if (savedSupervisionDescription) {\r\n  //     setSupervisionDescription(savedSupervisionDescription);\r\n  //   }\r\n  // }, []);\r\n\r\n  const handleSubmitOrder = async (orderId) => {\r\n    const token = localStorage.getItem(\"accessToken\");\r\n\r\n    // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª\r\n    if (!token) {\r\n      toast.warn(\"â›› Ø´Ù…Ø§ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯!\");\r\n      return;\r\n    }\r\n\r\n    // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ø³ÙØ§Ø±Ø´ Ùˆ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯\r\n    if (!orderId || tempSelectedVibrators.length === 0) {\r\n      toast.error(\"âŒ Ø³ÙØ§Ø±Ø´ ÛŒØ§ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª!\");\r\n      return;\r\n    }\r\n\r\n    const payload = [];\r\n\r\n    // Ø§ÛŒØ¬Ø§Ø¯ payload Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„\r\n    tempSelectedVibrators.forEach((vibrator) => {\r\n      const subVibratorsForThisVibrator = tempSelectedSubVibrators.filter(\r\n        (subVibrator) => subVibrator.vibratorId === vibrator.id\r\n      );\r\n\r\n      if (subVibratorsForThisVibrator.length > 0) {\r\n        // Ø§Ø±Ø³Ø§Ù„ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ùˆ Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ Ø¨Ø§ Ù‡Ù…\r\n        subVibratorsForThisVibrator.forEach((subVibrator) => {\r\n          payload.push({\r\n            order: Number(orderId),\r\n            vibrator: Number(vibrator.id),\r\n            count: Number(vibrator.count),\r\n            sub_vibrator: Number(subVibrator.id),\r\n          });\r\n        });\r\n      } else {\r\n        // ÙÙ‚Ø· ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø±Ø§ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…\r\n        payload.push({\r\n          order: Number(orderId),\r\n          vibrator: Number(vibrator.id),\r\n          count: Number(vibrator.count),\r\n          sub_vibrator: null,\r\n        });\r\n      }\r\n    });\r\n\r\n    try {\r\n      // Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±\r\n      const response = await axios.post(\r\n        \"https://amin-beton-back.chbk.app/api/orders/add-vibrator-order/\",\r\n        payload,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n        }\r\n      );\r\n\r\n      // Ø§Ú¯Ø± Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯\r\n      if (response.status === 200) {\r\n        console.log(\"âœ… Server Response:\", response.data);\r\n        toast.success(\"âœ” Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯!\");\r\n\r\n        // Ø±ÛŒÙ„ÙˆØ¯ ØµÙØ­Ù‡\r\n        location.reload(); // ØµÙØ­Ù‡ Ø±Ø§ Ø±ÛŒÙ„ÙˆØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯\r\n      } else {\r\n        setModalMessage(\"âŒ Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…Ø´Ú©Ù„ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯!\");\r\n        setIsModalOpen(true);\r\n      }\r\n    } catch (error) {\r\n      // Ø¯Ø± ØµÙˆØ±Øª Ø¨Ø±ÙˆØ² Ø®Ø·Ø§\r\n      console.error(\"âŒ Error Sending Request:\", error.response?.data || error);\r\n      setModalMessage(\r\n        error.response?.data?.message || \"âŒ Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…Ø´Ú©Ù„ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯!\"\r\n      );\r\n      setIsModalOpen(true);\r\n    }\r\n  };\r\n\r\n  const handleAddAndSubmit = async () => {\r\n    console.log(\"ğŸš€ handleAddAndSubmit Ø§Ø¬Ø±Ø§ Ø´Ø¯!\");\r\n\r\n    if (\r\n      tempSelectedVibrators.length === 0 &&\r\n      tempSelectedSubVibrators.length === 0\r\n    ) {\r\n      setModalMessage(\"âš ï¸ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ú©Ø±Ø¯ÛŒØ¯!\");\r\n      setIsModalOpen(true); // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù…ÙˆØ¯Ø§Ù„ Ø®Ø·Ø§\r\n      return;\r\n    }\r\n\r\n    console.log(\"ğŸ” Selected SubVibrators:\", tempSelectedSubVibrators);\r\n\r\n    // Ú†Ú© Ú©Ø±Ø¯Ù† orderId Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø±Ø³Ø§Ù„\r\n    if (!orderId) {\r\n      setModalMessage(\"âŒ Ø´Ù…Ø§Ø±Ù‡ Ø³ÙØ§Ø±Ø´ Ù…Ø´Ø®Øµ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª!\");\r\n      setIsModalOpen(true); // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù…ÙˆØ¯Ø§Ù„ Ø®Ø·Ø§\r\n      return;\r\n    }\r\n\r\n    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ØªØ¹Ø¯Ø§Ø¯ Ø¨Ù‡ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ Ùˆ Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§\r\n    const newVibrators = tempSelectedVibrators.map((vibrator) => ({\r\n      ...vibrator,\r\n      count: quantity,\r\n    }));\r\n\r\n    const newSubVibrators = tempSelectedSubVibrators.map((subVibrator) => ({\r\n      ...subVibrator,\r\n      count: quantity,\r\n    }));\r\n\r\n    const payload = [];\r\n\r\n    newVibrators.forEach((vibrator) => {\r\n      // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø§ÛŒÙ† ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±\r\n      const subVibratorsForThisVibrator = newSubVibrators.filter(\r\n        (subVibrator) => subVibrator.vibratorId === vibrator.id\r\n      );\r\n\r\n      if (subVibratorsForThisVibrator.length > 0) {\r\n        // Ø§Ú¯Ø± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø¯Ø§Ø±Ø¯ØŒ Ø§Ø±Ø³Ø§Ù„ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ùˆ Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±â€ŒÙ‡Ø§ Ø¨Ø§ Ù‡Ù…\r\n        subVibratorsForThisVibrator.forEach((subVibrator) => {\r\n          payload.push({\r\n            order: Number(orderId),\r\n            vibrator: Number(vibrator.id),\r\n            count: Number(vibrator.count),\r\n            sub_vibrator: Number(subVibrator.id), // Ø§Ø±Ø³Ø§Ù„ Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±\r\n          });\r\n        });\r\n      } else {\r\n        // Ø§Ú¯Ø± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ù†Ø¯Ø§Ø±Ø¯ØŒ ÙÙ‚Ø· ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø±Ø§ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…\r\n        payload.push({\r\n          order: Number(orderId),\r\n          vibrator: Number(vibrator.id),\r\n          count: vibrator.countable ? Number(vibrator.count) : 1,\r\n          sub_vibrator: null, // Ø¨Ø¯ÙˆÙ† Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±\r\n        });\r\n      }\r\n    });\r\n\r\n    // Ø§Ø±Ø³Ø§Ù„ ØªÙ…Ø§Ù…ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ Ø¨Ù‡ Ø³Ø±ÙˆØ±\r\n    console.log(\"ğŸ“¦ Payload:\", payload);\r\n\r\n    try {\r\n      const response = await axios.post(\r\n        \"https://amin-beton-back.chbk.app/api/orders/add-vibrator-order/\", // ÙØ±Ø¶ Ú©Ù†ÛŒØ¯ Ø§ÛŒÙ† Ø¢Ø¯Ø±Ø³ Ø¬Ø¯ÛŒØ¯ Ø§Ø³Øª\r\n        payload,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`,\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n        }\r\n      );\r\n\r\n      if (response.status === 200) {\r\n        console.log(\"âœ… Server Response:\", response.data);\r\n        toast.success(\"âœ” Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯!\");\r\n\r\n        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡\r\n        setSelectedVibrators((prev) => [...prev, ...newVibrators]);\r\n        setSelectedSubVibrators((prev) => [...prev, ...newSubVibrators]);\r\n\r\n        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙ‚Øª\r\n        setTempSelectedVibrators([]);\r\n        setTempSelectedSubVibrators([]);\r\n        setSubVibrators([]);\r\n        setQuantity(1);\r\n      } else {\r\n        setModalMessage(\"âŒ Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…Ø´Ú©Ù„ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯!\");\r\n        setIsModalOpen(true); // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù…ÙˆØ¯Ø§Ù„ Ø®Ø·Ø§\r\n      }\r\n    } catch (error) {\r\n      console.error(\"âŒ Error Sending Request:\", error.response?.data || error);\r\n      setModalMessage(\r\n        error.response?.data?.message || \"âŒ Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù…Ø´Ú©Ù„ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯!\"\r\n      );\r\n      setIsModalOpen(true); // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù…ÙˆØ¯Ø§Ù„ Ø®Ø·Ø§\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    const fetchOrderData = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const token = localStorage.getItem(\"accessToken\");\r\n\r\n        if (!token) {\r\n          toast.warn(\"â›› Ø´Ù…Ø§ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯!\");\r\n          return;\r\n        }\r\n\r\n        // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ Ø´Ø§Ù…Ù„ Ù¾Ù…Ù¾â€ŒÙ‡Ø§ Ùˆ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§\r\n        const orderDataRes = await axios.get(\r\n          `https://amin-beton-back.chbk.app/api/orders/${orderId}/`,\r\n          {\r\n            headers: { Authorization: `Bearer ${token}` },\r\n          }\r\n        );\r\n\r\n        console.log(\"Ù¾Ù…Ù¾â€ŒÙ‡Ø§ Ùˆ Ø²ÛŒØ±Ù¾Ù…Ù¾â€ŒÙ‡Ø§:\", orderDataRes.data); // Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ\r\n        console.log(\"ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ Ùˆ Ø²ÛŒØ±ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§:\", orderDataRes.data); // Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø§Ø³Ø® Ø¯Ø±ÛŒØ§ÙØªÛŒ\r\n\r\n        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±\r\n        setSelectedVibrators(orderDataRes.data.vibrators || []);\r\n        setSelectedSubVibrators(orderDataRes.data.subVibrators || []);\r\n      } catch (err) {\r\n        toast.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´!\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (orderId) {\r\n      fetchOrderData();\r\n    }\r\n  }, [orderId]);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      const token = localStorage.getItem(\"accessToken\");\r\n      if (!token) {\r\n        toast.error(\"â›› Ø´Ù…Ø§ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯!\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const { data } = await axios.get(\r\n          \"https://amin-beton-back.chbk.app/api/sales-vibrator/\",\r\n          { headers: { Authorization: `Bearer ${token}` } }\r\n        );\r\n        const parentVibrators = data.filter(\r\n          (vibrator) => vibrator.parent === null\r\n        );\r\n        setVibrators(parentVibrators); // Renamed variable from setPumps to setVibrators\r\n\r\n        const projectRes = await axios.get(\r\n          `https://amin-beton-back.chbk.app/api/orders/${orderId}/`,\r\n          { headers: { Authorization: `Bearer ${token}` } }\r\n        );\r\n        setProjectTitle(projectRes.data.title || \"Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†\");\r\n      } catch (err) {\r\n        toast.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª!\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [orderId]);\r\n\r\n  const fetchSubVibrators = async (id) => {\r\n    const token = localStorage.getItem(\"accessToken\");\r\n    if (!token) {\r\n      toast.error(\"â›› Ø´Ù…Ø§ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯!\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const { data } = await axios.get(\r\n        `https://amin-beton-back.chbk.app/api/sales-vibrator/${id}/sub-vibrators/`,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n\r\n      if (data && data.length > 0) {\r\n        setSubVibrators((prev) => {\r\n          // Changed setSubPumps to setSubVibrators\r\n          const newSubs = data.filter(\r\n            (subVibrator) =>\r\n              !prev.some((existing) => existing.id === subVibrator.id)\r\n          );\r\n          return [...prev, ...newSubs];\r\n        });\r\n      } else {\r\n        setSubVibrators([]); // Make sure you're using setSubVibrators here\r\n      }\r\n    } catch (err) {\r\n      toast.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø²ÛŒØ±Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±!\"); // Updated error message\r\n    }\r\n  };\r\n\r\n  const handleSubVibratorSelection = (subVibratorId) => {\r\n    if (quantity < 1) {\r\n      toast.warn(\"âš ï¸ Ù„Ø·ÙØ§Ù‹ ØªØ¹Ø¯Ø§Ø¯ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!\");\r\n      return;\r\n    }\r\n\r\n    const subVibrator = subVibrators.find((sv) => sv.id === subVibratorId);\r\n    if (!subVibrator) return;\r\n\r\n    // ÙÙ‚Ø· ÛŒÚ© ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒØ´Ù‡ Ù¾Ø³ Ø§ÙˆÙ„ Ø§ÙˆÙ† Ø±Ùˆ Ù…ÛŒâ€ŒÚ¯ÛŒØ±ÛŒÙ…\r\n    const selectedVibrator = tempSelectedVibrators[0];\r\n    if (!selectedVibrator) {\r\n      toast.warn(\"âš ï¸ Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯!\");\r\n      return;\r\n    }\r\n\r\n    const exists = tempSelectedSubVibrators.some(\r\n      (sv) => sv.id === subVibratorId && sv.vibratorId === selectedVibrator.id\r\n    );\r\n\r\n    if (exists) {\r\n      // Ø§Ú¯Ù‡ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø´Ù‡ØŒ Ø­Ø°Ù Ú©Ù†\r\n      setTempSelectedSubVibrators([]);\r\n    } else {\r\n      // Ù‚Ø¨Ù„ÛŒ Ø±Ùˆ Ø­Ø°Ù Ú©Ù† Ùˆ ÙÙ‚Ø· Ø§ÛŒÙ† Ø±Ùˆ Ø¨Ø°Ø§Ø±\r\n      setTempSelectedSubVibrators([\r\n        {\r\n          ...subVibrator,\r\n          count: quantity,\r\n          vibratorId: selectedVibrator.id,\r\n        },\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const handleQuantityChangeForVibrator = (id, value) => {\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue) || numericValue < 1) return;\r\n\r\n    // ØªØºÛŒÛŒØ± ØªØ¹Ø¯Ø§Ø¯ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡\r\n    setTempSelectedVibrators((prev) =>\r\n      prev.map((v) => (v.id === id ? { ...v, count: numericValue } : v))\r\n    );\r\n  };\r\n\r\n  const handleQuantityChangeForSubVibrator = (id, value) => {\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue) || numericValue < 1) return;\r\n\r\n    // ØªØºÛŒÛŒØ± ØªØ¹Ø¯Ø§Ø¯ Ø²ÛŒØ± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡\r\n    setTempSelectedSubVibrators((prev) =>\r\n      prev.map((sv) => (sv.id === id ? { ...sv, count: numericValue } : sv))\r\n    );\r\n  };\r\n\r\n  const handleTempQuantityChange = (id, value, isSubVibrator = false) => {\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue) || numericValue < 1) return;\r\n\r\n    if (isSubVibrator) {\r\n      setTempSelectedSubVibrators((prev) =>\r\n        prev.map((sv) => (sv.id === id ? { ...sv, count: numericValue } : sv))\r\n      );\r\n    } else {\r\n      setTempSelectedVibrators((prev) =>\r\n        prev.map((v) => (v.id === id ? { ...v, count: numericValue } : v))\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleQuantityChange = (e) => {\r\n    const updatedCount = Number(e.target.value);\r\n    if (!isNaN(updatedCount) && updatedCount >= 1) {\r\n      setQuantity(updatedCount); // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ù‚Ø¯Ø§Ø± quantity\r\n    }\r\n  };\r\n\r\n  const handleRemoveVibrator = (id, isSubVibrator = false) => {\r\n    if (isSubVibrator) {\r\n      setSelectedSubVibrators((prev) => prev.filter((sv) => sv.id !== id));\r\n    } else {\r\n      setSelectedVibrators((prev) => prev.filter((v) => v.id !== id));\r\n    }\r\n\r\n    deleteVibratorOrder(id);\r\n  };\r\n\r\n\r\n  //   if (!token) {\r\n  //     toast.warn(\"â›› Ø´Ù…Ø§ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯!\");\r\n  //     return;\r\n  //   }\r\n\r\n  //   try {\r\n  //     await axios.delete(\r\n  //       `https://amin-beton-back.chbk.app/api/vibrator-orders/${id}/`,\r\n  //       { headers: { Authorization: `Bearer ${token}` } }\r\n  //     );\r\n  //     toast.success(\"âœ… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯!\");\r\n  //   } catch (err) {\r\n  //     toast.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø­Ø°Ù Ø¢ÛŒØªÙ…!\");\r\n  //   }\r\n  // };\r\n  const handleDeleteVibratorOrder = async (vibratorOrderId) => {\r\n    const token = localStorage.getItem(\"accessToken\");\r\n    if (!token) {\r\n      toast.warn(\"â›› Ø´Ù…Ø§ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯!\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await axios.delete(\r\n        `https://amin-beton-back.chbk.app/api/vibrator-orders/${vibratorOrderId}/`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        }\r\n      );\r\n\r\n      toast.success(\"âœ” ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯!\");\r\n      // Ø­Ø°Ù Ø§Ø² UI\r\n      setSelectedVibrators((prev) =>\r\n        prev.filter((v) => v.id !== vibratorOrderId)\r\n      );\r\n    } catch (error) {\r\n      console.error(\"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø­Ø°Ù ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±:\", error.response?.data || error);\r\n      toast.error(\"âŒ Ø­Ø°Ù ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø¨Ø§ Ù…Ø´Ú©Ù„ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯!\");\r\n    }\r\n  };\r\n  const handleUpdateOrder = async () => {\r\n    const token = localStorage.getItem(\"accessToken\"); // Ø¯Ø±ÛŒØ§ÙØª ØªÙˆÚ©Ù† Ø§Ø² localStorage\r\n\r\n    // Ú†Ú© Ú©Ø±Ø¯Ù† Ø§ÛŒÙ†Ú©Ù‡ Ø¢ÛŒØ§ ØªÙˆÚ©Ù† ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯ ÛŒØ§ Ù†Ù‡\r\n    if (!token) {\r\n      setModalMessage(\"â›› Ø´Ù…Ø§ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯!\");\r\n      setIsModalOpen(true);\r\n      return;\r\n    }\r\n\r\n    const payload = {\r\n      sealing_implementation: supervisionSelected === \"yes\" ? \"Yes\" : \"No\",\r\n      power_trowel: malepSelected === \"yes\",\r\n      power_trowel_count: quantity,\r\n      additional_description: supervisionDescription,\r\n    };\r\n\r\n    try {\r\n      // Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Ø³Ø±ÙˆØ± Ø¨Ø±Ø§ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø³ÙØ§Ø±Ø´ Ø¨Ø§ Ù‡Ø¯Ø± Authorization\r\n      const response = await axios.patch(\r\n        `https://amin-beton-back.chbk.app/api/orders/${orderId}/`, // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² PATCH Ø¨Ù‡ Ø¬Ø§ÛŒ PUT\r\n        payload,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`, // Ø§Ø±Ø³Ø§Ù„ ØªÙˆÚ©Ù† Ø¯Ø± Ù‡Ø¯Ø±\r\n            \"Content-Type\": \"application/json\", // Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§\r\n          },\r\n        }\r\n      );\r\n\r\n      // Ø§Ú¯Ø± Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯\r\n      console.log(\"Order updated successfully:\", response.data);\r\n      setModalMessage(\"Order updated successfully\");\r\n      setIsModalOpen(true);\r\n\r\n      // Ø±ÛŒÙ„ÙˆØ¯ ØµÙØ­Ù‡ Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ ØªØºÛŒÛŒØ±Ø§Øª\r\n      location.reload();\r\n    } catch (error) {\r\n      console.error(\"Error updating order:\", error);\r\n      setModalMessage(\"There was an error updating the order.\");\r\n      setIsModalOpen(true);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col min-h-screen p-6 text-white bg-Bokara-Grey\">\r\n      <div className=\"container w-full max-w-5xl p-8 bg-gray-800 rounded-xl\">\r\n        <h1 className=\"mb-8 text-sm font-bold text-center md:text-2xl\">\r\n          Ø®Ø±ÛŒØ¯ Ø¨Ø±Ø§ÛŒ <br /> {projectTitle}\r\n        </h1>\r\n        {/* Form Fields for Sealing Implementation (Ø§Ø¬Ø±Ø§ Ùˆ Ù†Ø¸Ø§Ø±Øª Ø¢Ø¨â€ŒØ¨Ù†Ø¯ÛŒ) */}\r\n        <div className=\"flex flex-col gap-4 mb-8\">\r\n          <h2 className=\"text-lg font-bold\">Ø§Ø¬Ø±Ø§ Ùˆ Ù†Ø¸Ø§Ø±Øª Ø¢Ø¨â€ŒØ¨Ù†Ø¯ÛŒ</h2>\r\n          <div className=\"flex gap-4\">\r\n            <Button\r\n              className={`rounded-full w-16 h-16 flex items-center justify-center text-sm transition-all duration-200 ${\r\n                supervisionSelected === \"yes\"\r\n                  ? \"bg-School-Bus text-black\"\r\n                  : \"border border-white text-white\"\r\n              }`}\r\n              variant={supervisionSelected === \"yes\" ? \"default\" : \"outline\"}\r\n              onClick={() => setSupervisionSelected(\"yes\")}\r\n            >\r\n              Ø¨Ù„Ù‡\r\n            </Button>\r\n            <Button\r\n              className={`rounded-full w-16 h-16 flex items-center justify-center text-sm transition-all duration-200 ${\r\n                supervisionSelected === \"no\"\r\n                  ? \"bg-School-Bus text-black\"\r\n                  : \"border border-white text-white\"\r\n              }`}\r\n              variant={supervisionSelected === \"no\" ? \"default\" : \"outline\"}\r\n              onClick={() => setSupervisionSelected(\"no\")}\r\n            >\r\n              Ø®ÛŒØ±\r\n            </Button>\r\n          </div>\r\n\r\n          {supervisionSelected === \"yes\" && (\r\n            <div className=\"flex flex-col gap-2\">\r\n              <label htmlFor=\"supervisionDescription\">ØªÙˆØ¶ÛŒØ­Ø§Øª:</label>\r\n              <textarea\r\n                id=\"supervisionDescription\"\r\n                className=\"w-full p-2 text-black border rounded-md\"\r\n                rows={4}\r\n                placeholder=\"ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø§Ø¬Ø±Ø§ Ùˆ Ù†Ø¸Ø§Ø±Øª Ø¢Ø¨â€ŒØ¨Ù†Ø¯ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯...\"\r\n                value={supervisionDescription}\r\n                onChange={(e) => setSupervisionDescription(e.target.value)}\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Form Fields for Power Trowel (Ù…Ø§Ù„Ù‡ Ù¾Ø±ÙˆØ§Ù†Ù‡) */}\r\n        <div className=\"flex flex-col gap-4 mb-8\">\r\n          <h2 className=\"text-lg font-bold\">Ù…Ø§Ù„Ù‡ Ù¾Ø±ÙˆØ§Ù†Ù‡</h2>\r\n          <div className=\"flex gap-4\">\r\n            <Button\r\n              className={`rounded-full w-16 h-16 flex items-center justify-center text-sm transition-all duration-200 ${\r\n                malepSelected === \"yes\"\r\n                  ? \"bg-School-Bus text-black\"\r\n                  : \"border border-white text-white\"\r\n              }`}\r\n              variant=\"ghost\"\r\n              onClick={() => setMalepSelected(\"yes\")}\r\n            >\r\n              Ø¨Ù„Ù‡\r\n            </Button>\r\n            <Button\r\n              className={`rounded-full w-16 h-16 flex items-center justify-center text-sm transition-all duration-200 ${\r\n                malepSelected === \"no\"\r\n                  ? \"bg-School-Bus text-black\"\r\n                  : \"border border-white text-white\"\r\n              }`}\r\n              variant=\"ghost\"\r\n              onClick={() => setMalepSelected(\"no\")}\r\n            >\r\n              Ø®ÛŒØ±\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Submit Button to Update Order */}\r\n        {/* <div className=\"flex justify-center mb-8\">\r\n          <Button className=\"px-10\">Ø¨Ù‡ Ø±ÙˆØ² Ø±Ø³Ø§Ù†ÛŒ Ø³ÙØ§Ø±Ø´</Button>\r\n        </div> */}\r\n\r\n        <div className=\"flex justify-start mb-8\">\r\n          <Button\r\n            className=\"px-4 rounded-lg\"\r\n            onClick={() => setShowVibratorModal(true)}\r\n          >\r\n            Ø§Ù†ØªØ®Ø§Ø¨ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±\r\n          </Button>\r\n        </div>\r\n        {/* Ø§Ù†ØªØ®Ø§Ø¨ Ù†ÙˆØ¹ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± ÙˆÙ‚ØªÛŒ showVibratorSelection ÙØ¹Ø§Ù„ Ø´Ø¯ */}\r\n        {showVibratorSelection && (\r\n          <div className=\"mb-8\">\r\n            <h2 className=\"text-lg font-bold\">Ù†ÙˆØ¹ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±</h2>\r\n            <div className=\"flex flex-row flex-wrap gap-6 mt-4 mb-8\">\r\n              {vibrators.map((vibrator) => {\r\n                const isSelected = tempSelectedVibrators.some(\r\n                  (v) => v.id === vibrator.id\r\n                );\r\n\r\n                return (\r\n                  <div\r\n                    key={vibrator.id}\r\n                    className={`flex flex-col gap-2 items-center justify-center text-center w-40 border ${\r\n                      isSelected ? \"border-School-Bus\" : \"border-white\"\r\n                    } rounded-lg px-4 py-4 cursor-pointer transition-all duration-200 hover:scale-105`}\r\n                    onClick={() => handleVibratorSelection(vibrator.id)}\r\n                  >\r\n                    <div\r\n                      className={`w-4 h-4 mb-2 rounded-full ${\r\n                        isSelected ? \"bg-School-Bus\" : \"bg-white\"\r\n                      }`}\r\n                    ></div>\r\n                    <div className=\"mb-2\">{vibrator.title}</div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n\r\n            {tempSelectedVibrators.length > 0 && subVibrators.length > 0 && (\r\n              <div className=\"mb-8\">\r\n                <h3 className=\"text-lg font-bold\">Ø²ÛŒØ±Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±</h3>\r\n                <div className=\"flex flex-row flex-wrap gap-6 mt-4\">\r\n                  {subVibrators.map((subVibrator) => {\r\n                    const isSelected = tempSelectedSubVibrators.some(\r\n                      (sv) => sv.id === subVibrator.id\r\n                    );\r\n\r\n                    return (\r\n                      <div\r\n                        key={subVibrator.id}\r\n                        className={`flex flex-col gap-2 items-center justify-center text-center w-40 border ${\r\n                          isSelected ? \"border-School-Bus\" : \"border-white\"\r\n                        } rounded-lg px-4 py-4 cursor-pointer transition-all duration-200 hover:scale-105`}\r\n                        onClick={() =>\r\n                          handleSubVibratorSelection(subVibrator.id)\r\n                        }\r\n                      >\r\n                        <div\r\n                          className={`w-4 h-4 mb-2 rounded-full ${\r\n                            isSelected ? \"bg-School-Bus\" : \"bg-white\"\r\n                          }`}\r\n                        ></div>\r\n                        <div className=\"mb-2\">{subVibrator.title}</div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* ÙÛŒÙ„Ø¯ ØªØ¹Ø¯Ø§Ø¯ */}\r\n            {tempSelectedVibrators.some((vibrator) => vibrator.countable) && (\r\n              <div className=\"flex items-center gap-2\">\r\n                <label htmlFor=\"totalQty\">ØªØ¹Ø¯Ø§Ø¯:</label>\r\n                <input\r\n                  id=\"totalQty\"\r\n                  type=\"number\"\r\n                  min=\"1\"\r\n                  value={quantity}\r\n                  onChange={handleQuantityChange}\r\n                  className=\"w-20 p-1 text-black border rounded-md\"\r\n                />\r\n              </div>\r\n            )}\r\n            {/* Ø¯Ú©Ù…Ù‡ Ø§ÙØ²ÙˆØ¯Ù† ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± */}\r\n            <div className=\"flex justify-center gap-6 px-10 mt-10\">\r\n              <Button className=\"px-10\" onClick={handleAddAndSubmit}>\r\n                Ø§ÙØ²ÙˆØ¯Ù† ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        )}\r\n        {/* Ù†Ù…Ø§ÛŒØ´ Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± */}\r\n        <div className=\"mb-8\">\r\n          <h3 className=\"text-lg font-bold\">\r\n            ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ø«Ø¨Øªâ€ŒØ´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø³ÙØ§Ø±Ø´\r\n          </h3>\r\n          <div className=\"flex flex-row flex-wrap gap-6 mt-4\">\r\n            {selectedVibrators.map((vibrator) => {\r\n              if (!vibrator.vibrator || !vibrator.vibrator.title) {\r\n                return null;\r\n              }\r\n\r\n              // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø²ÛŒØ±ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù‡Ø± ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±\r\n              const subVibratorsForThis = vibrator.sub_vibrator\r\n                ? [vibrator.sub_vibrator]\r\n                : [];\r\n\r\n              return (\r\n                <div\r\n                  key={vibrator.id}\r\n                  className=\"flex flex-col items-center justify-center w-40 gap-2 px-4 py-4 text-center border rounded-lg border-School-Bus\"\r\n                >\r\n                  <div className=\"w-4 h-4 mb-2 rounded-full bg-School-Bus\"></div>\r\n                  <div className=\"mb-2\">\r\n                    {vibrator.vibrator?.title || \"ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ù†Ø§Ù…Ø´Ø®Øµ\"}\r\n                  </div>\r\n                  <div>ØªØ¹Ø¯Ø§Ø¯ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±: {vibrator.count}</div>\r\n                  {subVibratorsForThis.length > 0 && (\r\n                    <div>\r\n                      {subVibratorsForThis.map((sub_vibrator) => (\r\n                        <div key={sub_vibrator.id} className=\"text-sm\">\r\n                          Ø²ÛŒØ±ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ±: {sub_vibrator.title}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                  <button\r\n                    className=\"border-none text-red\"\r\n                    onClick={() => handleDeleteVibratorOrder(vibrator.id)}\r\n                  >\r\n                    Ø­Ø°Ù\r\n                  </button>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n\r\n          <Button\r\n            className=\"px-10\"\r\n            onClick={() => {\r\n              handleUpdateOrder();\r\n              handleAddAndSubmit();\r\n\r\n              // navigate(`/FormPage/${orderId}`); // ÛŒØ§ Ù‡Ø± Ù…Ø³ÛŒØ± Ù…Ø±Ø­Ù„Ù‡â€ŒÛŒ Ø¨Ø¹Ø¯ÛŒ Ú©Ù‡ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø§Ø´Ù‡\r\n            }}\r\n          >\r\n            Ø§Ø¯Ø§Ù…Ù‡\r\n          </Button>\r\n          <Modal\r\n            isOpen={isModalOpen}\r\n            onClose={() => setIsModalOpen(false)}\r\n            message={modalMessage}\r\n          />\r\n        </div>\r\n\r\n        {showVibratorModal && (\r\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\">\r\n            <div className=\"p-8 text-black bg-white rounded-lg w-96\">\r\n              <h2 className=\"mb-4 text-lg font-bold text-center\">\r\n                Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ØŸ\r\n              </h2>\r\n              <div className=\"flex justify-center gap-4\">\r\n                <Button\r\n                  className=\"px-2\"\r\n                  onClick={() => {\r\n                    setShowVibratorSelection(true); // Ø¨Ø®Ø´ Ø§Ù†ØªØ®Ø§Ø¨ ÙˆÛŒØ¨Ø±Ø§ØªÙˆØ± Ø¨Ø§Ø² Ø´Ù‡\r\n                    setShowVibratorModal(false); // Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø³ØªÙ‡ Ø´Ù‡\r\n                  }}\r\n                >\r\n                  Ø¨Ù„Ù‡\r\n                </Button>\r\n                <Button\r\n                  className=\"px-2\"\r\n                  variant=\"outline\"\r\n                  onClick={() => setShowVibratorModal(false)} // ÙÙ‚Ø· Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø¨Ù†Ø¯\r\n                >\r\n                  Ø®ÛŒØ±\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n      <Modal\r\n        isOpen={isModalOpen}\r\n        onClose={() => setIsModalOpen(false)}\r\n        message={modalMessage}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VibratorPage;\r\n"
        }
    ]
}